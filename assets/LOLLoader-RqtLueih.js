var ur=Object.defineProperty;var fr=(i,t,e)=>t in i?ur(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var w=(i,t,e)=>(fr(i,typeof t!="symbol"?t+"":t,e),e);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function ne(i){let t=i.length;for(;--t>=0;)i[t]=0}const dr=0,Ss=1,pr=2,mr=3,_r=258,nn=29,ze=256,xe=ze+1+nn,jt=30,sn=19,zs=2*xe+1,Dt=15,pi=16,xr=7,rn=256,ks=16,vs=17,Es=18,Hi=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ke=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),gr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Fs=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yr=512,_t=new Array((xe+2)*2);ne(_t);const pe=new Array(jt*2);ne(pe);const ge=new Array(yr);ne(ge);const ye=new Array(_r-mr+1);ne(ye);const an=new Array(nn);ne(an);const ni=new Array(jt);ne(ni);function mi(i,t,e,n,s){this.static_tree=i,this.extra_bits=t,this.extra_base=e,this.elems=n,this.max_length=s,this.has_stree=i&&i.length}let Ts,Cs,Rs;function _i(i,t){this.dyn_tree=i,this.max_code=0,this.stat_desc=t}const Ds=i=>i<256?ge[i]:ge[256+(i>>>7)],be=(i,t)=>{i.pending_buf[i.pending++]=t&255,i.pending_buf[i.pending++]=t>>>8&255},X=(i,t,e)=>{i.bi_valid>pi-e?(i.bi_buf|=t<<i.bi_valid&65535,be(i,i.bi_buf),i.bi_buf=t>>pi-i.bi_valid,i.bi_valid+=e-pi):(i.bi_buf|=t<<i.bi_valid&65535,i.bi_valid+=e)},at=(i,t,e)=>{X(i,e[t*2],e[t*2+1])},Bs=(i,t)=>{let e=0;do e|=i&1,i>>>=1,e<<=1;while(--t>0);return e>>>1},br=i=>{i.bi_valid===16?(be(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},wr=(i,t)=>{const e=t.dyn_tree,n=t.max_code,s=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let h,l,f,d,u,p,m=0;for(d=0;d<=Dt;d++)i.bl_count[d]=0;for(e[i.heap[i.heap_max]*2+1]=0,h=i.heap_max+1;h<zs;h++)l=i.heap[h],d=e[e[l*2+1]*2+1]+1,d>c&&(d=c,m++),e[l*2+1]=d,!(l>n)&&(i.bl_count[d]++,u=0,l>=a&&(u=o[l-a]),p=e[l*2],i.opt_len+=p*(d+u),r&&(i.static_len+=p*(s[l*2+1]+u)));if(m!==0){do{for(d=c-1;i.bl_count[d]===0;)d--;i.bl_count[d]--,i.bl_count[d+1]+=2,i.bl_count[c]--,m-=2}while(m>0);for(d=c;d!==0;d--)for(l=i.bl_count[d];l!==0;)f=i.heap[--h],!(f>n)&&(e[f*2+1]!==d&&(i.opt_len+=(d-e[f*2+1])*e[f*2],e[f*2+1]=d),l--)}},Is=(i,t,e)=>{const n=new Array(Dt+1);let s=0,r,o;for(r=1;r<=Dt;r++)s=s+e[r-1]<<1,n[r]=s;for(o=0;o<=t;o++){let a=i[o*2+1];a!==0&&(i[o*2]=Bs(n[a]++,a))}},Mr=()=>{let i,t,e,n,s;const r=new Array(Dt+1);for(e=0,n=0;n<nn-1;n++)for(an[n]=e,i=0;i<1<<Hi[n];i++)ye[e++]=n;for(ye[e-1]=n,s=0,n=0;n<16;n++)for(ni[n]=s,i=0;i<1<<Ke[n];i++)ge[s++]=n;for(s>>=7;n<jt;n++)for(ni[n]=s<<7,i=0;i<1<<Ke[n]-7;i++)ge[256+s++]=n;for(t=0;t<=Dt;t++)r[t]=0;for(i=0;i<=143;)_t[i*2+1]=8,i++,r[8]++;for(;i<=255;)_t[i*2+1]=9,i++,r[9]++;for(;i<=279;)_t[i*2+1]=7,i++,r[7]++;for(;i<=287;)_t[i*2+1]=8,i++,r[8]++;for(Is(_t,xe+1,r),i=0;i<jt;i++)pe[i*2+1]=5,pe[i*2]=Bs(i,5);Ts=new mi(_t,Hi,ze+1,xe,Dt),Cs=new mi(pe,Ke,0,jt,Dt),Rs=new mi(new Array(0),gr,0,sn,xr)},Os=i=>{let t;for(t=0;t<xe;t++)i.dyn_ltree[t*2]=0;for(t=0;t<jt;t++)i.dyn_dtree[t*2]=0;for(t=0;t<sn;t++)i.bl_tree[t*2]=0;i.dyn_ltree[rn*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},Us=i=>{i.bi_valid>8?be(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},fn=(i,t,e,n)=>{const s=t*2,r=e*2;return i[s]<i[r]||i[s]===i[r]&&n[t]<=n[e]},xi=(i,t,e)=>{const n=i.heap[e];let s=e<<1;for(;s<=i.heap_len&&(s<i.heap_len&&fn(t,i.heap[s+1],i.heap[s],i.depth)&&s++,!fn(t,n,i.heap[s],i.depth));)i.heap[e]=i.heap[s],e=s,s<<=1;i.heap[e]=n},dn=(i,t,e)=>{let n,s,r=0,o,a;if(i.sym_next!==0)do n=i.pending_buf[i.sym_buf+r++]&255,n+=(i.pending_buf[i.sym_buf+r++]&255)<<8,s=i.pending_buf[i.sym_buf+r++],n===0?at(i,s,t):(o=ye[s],at(i,o+ze+1,t),a=Hi[o],a!==0&&(s-=an[o],X(i,s,a)),n--,o=Ds(n),at(i,o,e),a=Ke[o],a!==0&&(n-=ni[o],X(i,n,a)));while(r<i.sym_next);at(i,rn,t)},$i=(i,t)=>{const e=t.dyn_tree,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,r=t.stat_desc.elems;let o,a,c=-1,h;for(i.heap_len=0,i.heap_max=zs,o=0;o<r;o++)e[o*2]!==0?(i.heap[++i.heap_len]=c=o,i.depth[o]=0):e[o*2+1]=0;for(;i.heap_len<2;)h=i.heap[++i.heap_len]=c<2?++c:0,e[h*2]=1,i.depth[h]=0,i.opt_len--,s&&(i.static_len-=n[h*2+1]);for(t.max_code=c,o=i.heap_len>>1;o>=1;o--)xi(i,e,o);h=r;do o=i.heap[1],i.heap[1]=i.heap[i.heap_len--],xi(i,e,1),a=i.heap[1],i.heap[--i.heap_max]=o,i.heap[--i.heap_max]=a,e[h*2]=e[o*2]+e[a*2],i.depth[h]=(i.depth[o]>=i.depth[a]?i.depth[o]:i.depth[a])+1,e[o*2+1]=e[a*2+1]=h,i.heap[1]=h++,xi(i,e,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],wr(i,t),Is(e,c,i.bl_count)},pn=(i,t,e)=>{let n,s=-1,r,o=t[0*2+1],a=0,c=7,h=4;for(o===0&&(c=138,h=3),t[(e+1)*2+1]=65535,n=0;n<=e;n++)r=o,o=t[(n+1)*2+1],!(++a<c&&r===o)&&(a<h?i.bl_tree[r*2]+=a:r!==0?(r!==s&&i.bl_tree[r*2]++,i.bl_tree[ks*2]++):a<=10?i.bl_tree[vs*2]++:i.bl_tree[Es*2]++,a=0,s=r,o===0?(c=138,h=3):r===o?(c=6,h=3):(c=7,h=4))},mn=(i,t,e)=>{let n,s=-1,r,o=t[0*2+1],a=0,c=7,h=4;for(o===0&&(c=138,h=3),n=0;n<=e;n++)if(r=o,o=t[(n+1)*2+1],!(++a<c&&r===o)){if(a<h)do at(i,r,i.bl_tree);while(--a!==0);else r!==0?(r!==s&&(at(i,r,i.bl_tree),a--),at(i,ks,i.bl_tree),X(i,a-3,2)):a<=10?(at(i,vs,i.bl_tree),X(i,a-3,3)):(at(i,Es,i.bl_tree),X(i,a-11,7));a=0,s=r,o===0?(c=138,h=3):r===o?(c=6,h=3):(c=7,h=4)}},Ar=i=>{let t;for(pn(i,i.dyn_ltree,i.l_desc.max_code),pn(i,i.dyn_dtree,i.d_desc.max_code),$i(i,i.bl_desc),t=sn-1;t>=3&&i.bl_tree[Fs[t]*2+1]===0;t--);return i.opt_len+=3*(t+1)+5+5+4,t},Sr=(i,t,e,n)=>{let s;for(X(i,t-257,5),X(i,e-1,5),X(i,n-4,4),s=0;s<n;s++)X(i,i.bl_tree[Fs[s]*2+1],3);mn(i,i.dyn_ltree,t-1),mn(i,i.dyn_dtree,e-1)},zr=i=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&i.dyn_ltree[e*2]!==0)return 0;if(i.dyn_ltree[9*2]!==0||i.dyn_ltree[10*2]!==0||i.dyn_ltree[13*2]!==0)return 1;for(e=32;e<ze;e++)if(i.dyn_ltree[e*2]!==0)return 1;return 0};let _n=!1;const kr=i=>{_n||(Mr(),_n=!0),i.l_desc=new _i(i.dyn_ltree,Ts),i.d_desc=new _i(i.dyn_dtree,Cs),i.bl_desc=new _i(i.bl_tree,Rs),i.bi_buf=0,i.bi_valid=0,Os(i)},Ls=(i,t,e,n)=>{X(i,(dr<<1)+(n?1:0),3),Us(i),be(i,e),be(i,~e),e&&i.pending_buf.set(i.window.subarray(t,t+e),i.pending),i.pending+=e},vr=i=>{X(i,Ss<<1,3),at(i,rn,_t),br(i)},Er=(i,t,e,n)=>{let s,r,o=0;i.level>0?(i.strm.data_type===2&&(i.strm.data_type=zr(i)),$i(i,i.l_desc),$i(i,i.d_desc),o=Ar(i),s=i.opt_len+3+7>>>3,r=i.static_len+3+7>>>3,r<=s&&(s=r)):s=r=e+5,e+4<=s&&t!==-1?Ls(i,t,e,n):i.strategy===4||r===s?(X(i,(Ss<<1)+(n?1:0),3),dn(i,_t,pe)):(X(i,(pr<<1)+(n?1:0),3),Sr(i,i.l_desc.max_code+1,i.d_desc.max_code+1,o+1),dn(i,i.dyn_ltree,i.dyn_dtree)),Os(i),n&&Us(i)},Fr=(i,t,e)=>(i.pending_buf[i.sym_buf+i.sym_next++]=t,i.pending_buf[i.sym_buf+i.sym_next++]=t>>8,i.pending_buf[i.sym_buf+i.sym_next++]=e,t===0?i.dyn_ltree[e*2]++:(i.matches++,t--,i.dyn_ltree[(ye[e]+ze+1)*2]++,i.dyn_dtree[Ds(t)*2]++),i.sym_next===i.sym_end);var Tr=kr,Cr=Ls,Rr=Er,Dr=Fr,Br=vr,Ir={_tr_init:Tr,_tr_stored_block:Cr,_tr_flush_block:Rr,_tr_tally:Dr,_tr_align:Br};const Or=(i,t,e,n)=>{let s=i&65535|0,r=i>>>16&65535|0,o=0;for(;e!==0;){o=e>2e3?2e3:e,e-=o;do s=s+t[n++]|0,r=r+s|0;while(--o);s%=65521,r%=65521}return s|r<<16|0};var we=Or;const Ur=()=>{let i,t=[];for(var e=0;e<256;e++){i=e;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;t[e]=i}return t},Lr=new Uint32Array(Ur()),Nr=(i,t,e,n)=>{const s=Lr,r=n+e;i^=-1;for(let o=n;o<r;o++)i=i>>>8^s[(i^t[o])&255];return i^-1};var N=Nr,te={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ke={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Zr,_tr_stored_block:Wi,_tr_flush_block:Pr,_tr_tally:zt,_tr_align:Hr}=Ir,{Z_NO_FLUSH:kt,Z_PARTIAL_FLUSH:$r,Z_FULL_FLUSH:Wr,Z_FINISH:K,Z_BLOCK:xn,Z_OK:Z,Z_STREAM_END:gn,Z_STREAM_ERROR:ot,Z_DATA_ERROR:qr,Z_BUF_ERROR:gi,Z_DEFAULT_COMPRESSION:Xr,Z_FILTERED:Yr,Z_HUFFMAN_ONLY:Ue,Z_RLE:Vr,Z_FIXED:Gr,Z_DEFAULT_STRATEGY:Jr,Z_UNKNOWN:jr,Z_DEFLATED:oi}=ke,Kr=9,Qr=15,ta=8,ea=29,ia=256,qi=ia+1+ea,na=30,sa=19,ra=2*qi+1,aa=15,T=3,St=258,lt=St+T+1,ha=32,ee=42,hn=57,Xi=69,Yi=73,Vi=91,Gi=103,Bt=113,fe=666,$=1,se=2,Lt=3,re=4,oa=3,It=(i,t)=>(i.msg=te[t],t),yn=i=>i*2-(i>4?9:0),At=i=>{let t=i.length;for(;--t>=0;)i[t]=0},la=i=>{let t,e,n,s=i.w_size;t=i.hash_size,n=t;do e=i.head[--n],i.head[n]=e>=s?e-s:0;while(--t);t=s,n=t;do e=i.prev[--n],i.prev[n]=e>=s?e-s:0;while(--t)};let ca=(i,t,e)=>(t<<i.hash_shift^e)&i.hash_mask,vt=ca;const G=i=>{const t=i.state;let e=t.pending;e>i.avail_out&&(e=i.avail_out),e!==0&&(i.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),i.next_out),i.next_out+=e,t.pending_out+=e,i.total_out+=e,i.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},J=(i,t)=>{Pr(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,t),i.block_start=i.strstart,G(i.strm)},R=(i,t)=>{i.pending_buf[i.pending++]=t},ae=(i,t)=>{i.pending_buf[i.pending++]=t>>>8&255,i.pending_buf[i.pending++]=t&255},Ji=(i,t,e,n)=>{let s=i.avail_in;return s>n&&(s=n),s===0?0:(i.avail_in-=s,t.set(i.input.subarray(i.next_in,i.next_in+s),e),i.state.wrap===1?i.adler=we(i.adler,t,s,e):i.state.wrap===2&&(i.adler=N(i.adler,t,s,e)),i.next_in+=s,i.total_in+=s,s)},Ns=(i,t)=>{let e=i.max_chain_length,n=i.strstart,s,r,o=i.prev_length,a=i.nice_match;const c=i.strstart>i.w_size-lt?i.strstart-(i.w_size-lt):0,h=i.window,l=i.w_mask,f=i.prev,d=i.strstart+St;let u=h[n+o-1],p=h[n+o];i.prev_length>=i.good_match&&(e>>=2),a>i.lookahead&&(a=i.lookahead);do if(s=t,!(h[s+o]!==p||h[s+o-1]!==u||h[s]!==h[n]||h[++s]!==h[n+1])){n+=2,s++;do;while(h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&h[++n]===h[++s]&&n<d);if(r=St-(d-n),n=d-St,r>o){if(i.match_start=t,o=r,r>=a)break;u=h[n+o-1],p=h[n+o]}}while((t=f[t&l])>c&&--e!==0);return o<=i.lookahead?o:i.lookahead},ie=i=>{const t=i.w_size;let e,n,s;do{if(n=i.window_size-i.lookahead-i.strstart,i.strstart>=t+(t-lt)&&(i.window.set(i.window.subarray(t,t+t-n),0),i.match_start-=t,i.strstart-=t,i.block_start-=t,i.insert>i.strstart&&(i.insert=i.strstart),la(i),n+=t),i.strm.avail_in===0)break;if(e=Ji(i.strm,i.window,i.strstart+i.lookahead,n),i.lookahead+=e,i.lookahead+i.insert>=T)for(s=i.strstart-i.insert,i.ins_h=i.window[s],i.ins_h=vt(i,i.ins_h,i.window[s+1]);i.insert&&(i.ins_h=vt(i,i.ins_h,i.window[s+T-1]),i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++,i.insert--,!(i.lookahead+i.insert<T)););}while(i.lookahead<lt&&i.strm.avail_in!==0)},Zs=(i,t)=>{let e=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,n,s,r,o=0,a=i.strm.avail_in;do{if(n=65535,r=i.bi_valid+42>>3,i.strm.avail_out<r||(r=i.strm.avail_out-r,s=i.strstart-i.block_start,n>s+i.strm.avail_in&&(n=s+i.strm.avail_in),n>r&&(n=r),n<e&&(n===0&&t!==K||t===kt||n!==s+i.strm.avail_in)))break;o=t===K&&n===s+i.strm.avail_in?1:0,Wi(i,0,0,o),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,G(i.strm),s&&(s>n&&(s=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+s),i.strm.next_out),i.strm.next_out+=s,i.strm.avail_out-=s,i.strm.total_out+=s,i.block_start+=s,n-=s),n&&(Ji(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(o===0);return a-=i.strm.avail_in,a&&(a>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=a&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-a,i.strm.next_in),i.strstart),i.strstart+=a,i.insert+=a>i.w_size-i.insert?i.w_size-i.insert:a),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),o?re:t!==kt&&t!==K&&i.strm.avail_in===0&&i.strstart===i.block_start?se:(r=i.window_size-i.strstart,i.strm.avail_in>r&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,r+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),r>i.strm.avail_in&&(r=i.strm.avail_in),r&&(Ji(i.strm,i.window,i.strstart,r),i.strstart+=r,i.insert+=r>i.w_size-i.insert?i.w_size-i.insert:r),i.high_water<i.strstart&&(i.high_water=i.strstart),r=i.bi_valid+42>>3,r=i.pending_buf_size-r>65535?65535:i.pending_buf_size-r,e=r>i.w_size?i.w_size:r,s=i.strstart-i.block_start,(s>=e||(s||t===K)&&t!==kt&&i.strm.avail_in===0&&s<=r)&&(n=s>r?r:s,o=t===K&&i.strm.avail_in===0&&n===s?1:0,Wi(i,i.block_start,n,o),i.block_start+=n,G(i.strm)),o?Lt:$)},yi=(i,t)=>{let e,n;for(;;){if(i.lookahead<lt){if(ie(i),i.lookahead<lt&&t===kt)return $;if(i.lookahead===0)break}if(e=0,i.lookahead>=T&&(i.ins_h=vt(i,i.ins_h,i.window[i.strstart+T-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),e!==0&&i.strstart-e<=i.w_size-lt&&(i.match_length=Ns(i,e)),i.match_length>=T)if(n=zt(i,i.strstart-i.match_start,i.match_length-T),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=T){i.match_length--;do i.strstart++,i.ins_h=vt(i,i.ins_h,i.window[i.strstart+T-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=vt(i,i.ins_h,i.window[i.strstart+1]);else n=zt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(n&&(J(i,!1),i.strm.avail_out===0))return $}return i.insert=i.strstart<T-1?i.strstart:T-1,t===K?(J(i,!0),i.strm.avail_out===0?Lt:re):i.sym_next&&(J(i,!1),i.strm.avail_out===0)?$:se},Pt=(i,t)=>{let e,n,s;for(;;){if(i.lookahead<lt){if(ie(i),i.lookahead<lt&&t===kt)return $;if(i.lookahead===0)break}if(e=0,i.lookahead>=T&&(i.ins_h=vt(i,i.ins_h,i.window[i.strstart+T-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=T-1,e!==0&&i.prev_length<i.max_lazy_match&&i.strstart-e<=i.w_size-lt&&(i.match_length=Ns(i,e),i.match_length<=5&&(i.strategy===Yr||i.match_length===T&&i.strstart-i.match_start>4096)&&(i.match_length=T-1)),i.prev_length>=T&&i.match_length<=i.prev_length){s=i.strstart+i.lookahead-T,n=zt(i,i.strstart-1-i.prev_match,i.prev_length-T),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=s&&(i.ins_h=vt(i,i.ins_h,i.window[i.strstart+T-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=T-1,i.strstart++,n&&(J(i,!1),i.strm.avail_out===0))return $}else if(i.match_available){if(n=zt(i,0,i.window[i.strstart-1]),n&&J(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return $}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(n=zt(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<T-1?i.strstart:T-1,t===K?(J(i,!0),i.strm.avail_out===0?Lt:re):i.sym_next&&(J(i,!1),i.strm.avail_out===0)?$:se},ua=(i,t)=>{let e,n,s,r;const o=i.window;for(;;){if(i.lookahead<=St){if(ie(i),i.lookahead<=St&&t===kt)return $;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=T&&i.strstart>0&&(s=i.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){r=i.strstart+St;do;while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<r);i.match_length=St-(r-s),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=T?(e=zt(i,1,i.match_length-T),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(e=zt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),e&&(J(i,!1),i.strm.avail_out===0))return $}return i.insert=0,t===K?(J(i,!0),i.strm.avail_out===0?Lt:re):i.sym_next&&(J(i,!1),i.strm.avail_out===0)?$:se},fa=(i,t)=>{let e;for(;;){if(i.lookahead===0&&(ie(i),i.lookahead===0)){if(t===kt)return $;break}if(i.match_length=0,e=zt(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,e&&(J(i,!1),i.strm.avail_out===0))return $}return i.insert=0,t===K?(J(i,!0),i.strm.avail_out===0?Lt:re):i.sym_next&&(J(i,!1),i.strm.avail_out===0)?$:se};function rt(i,t,e,n,s){this.good_length=i,this.max_lazy=t,this.nice_length=e,this.max_chain=n,this.func=s}const de=[new rt(0,0,0,0,Zs),new rt(4,4,8,4,yi),new rt(4,5,16,8,yi),new rt(4,6,32,32,yi),new rt(4,4,16,16,Pt),new rt(8,16,32,32,Pt),new rt(8,16,128,128,Pt),new rt(8,32,128,256,Pt),new rt(32,128,258,1024,Pt),new rt(32,258,258,4096,Pt)],da=i=>{i.window_size=2*i.w_size,At(i.head),i.max_lazy_match=de[i.level].max_lazy,i.good_match=de[i.level].good_length,i.nice_match=de[i.level].nice_length,i.max_chain_length=de[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=T-1,i.match_available=0,i.ins_h=0};function pa(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=oi,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ra*2),this.dyn_dtree=new Uint16Array((2*na+1)*2),this.bl_tree=new Uint16Array((2*sa+1)*2),At(this.dyn_ltree),At(this.dyn_dtree),At(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(aa+1),this.heap=new Uint16Array(2*qi+1),At(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*qi+1),At(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const ve=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.status!==ee&&t.status!==hn&&t.status!==Xi&&t.status!==Yi&&t.status!==Vi&&t.status!==Gi&&t.status!==Bt&&t.status!==fe?1:0},Ps=i=>{if(ve(i))return It(i,ot);i.total_in=i.total_out=0,i.data_type=jr;const t=i.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?hn:t.wrap?ee:Bt,i.adler=t.wrap===2?0:1,t.last_flush=-2,Zr(t),Z},Hs=i=>{const t=Ps(i);return t===Z&&da(i.state),t},ma=(i,t)=>ve(i)||i.state.wrap!==2?ot:(i.state.gzhead=t,Z),$s=(i,t,e,n,s,r)=>{if(!i)return ot;let o=1;if(t===Xr&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>Kr||e!==oi||n<8||n>15||t<0||t>9||r<0||r>Gr||n===8&&o!==1)return It(i,ot);n===8&&(n=9);const a=new pa;return i.state=a,a.strm=i,a.status=ee,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+T-1)/T),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=(a.lit_bufsize-1)*3,a.level=t,a.strategy=r,a.method=e,Hs(i)},_a=(i,t)=>$s(i,t,oi,Qr,ta,Jr),xa=(i,t)=>{if(ve(i)||t>xn||t<0)return i?It(i,ot):ot;const e=i.state;if(!i.output||i.avail_in!==0&&!i.input||e.status===fe&&t!==K)return It(i,i.avail_out===0?gi:ot);const n=e.last_flush;if(e.last_flush=t,e.pending!==0){if(G(i),i.avail_out===0)return e.last_flush=-1,Z}else if(i.avail_in===0&&yn(t)<=yn(n)&&t!==K)return It(i,gi);if(e.status===fe&&i.avail_in!==0)return It(i,gi);if(e.status===ee&&e.wrap===0&&(e.status=Bt),e.status===ee){let s=oi+(e.w_bits-8<<4)<<8,r=-1;if(e.strategy>=Ue||e.level<2?r=0:e.level<6?r=1:e.level===6?r=2:r=3,s|=r<<6,e.strstart!==0&&(s|=ha),s+=31-s%31,ae(e,s),e.strstart!==0&&(ae(e,i.adler>>>16),ae(e,i.adler&65535)),i.adler=1,e.status=Bt,G(i),e.pending!==0)return e.last_flush=-1,Z}if(e.status===hn){if(i.adler=0,R(e,31),R(e,139),R(e,8),e.gzhead)R(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),R(e,e.gzhead.time&255),R(e,e.gzhead.time>>8&255),R(e,e.gzhead.time>>16&255),R(e,e.gzhead.time>>24&255),R(e,e.level===9?2:e.strategy>=Ue||e.level<2?4:0),R(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(R(e,e.gzhead.extra.length&255),R(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(i.adler=N(i.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=Xi;else if(R(e,0),R(e,0),R(e,0),R(e,0),R(e,0),R(e,e.level===9?2:e.strategy>=Ue||e.level<2?4:0),R(e,oa),e.status=Bt,G(i),e.pending!==0)return e.last_flush=-1,Z}if(e.status===Xi){if(e.gzhead.extra){let s=e.pending,r=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+r>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s)),e.gzindex+=a,G(i),e.pending!==0)return e.last_flush=-1,Z;s=0,r-=a}let o=new Uint8Array(e.gzhead.extra);e.pending_buf.set(o.subarray(e.gzindex,e.gzindex+r),e.pending),e.pending+=r,e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s)),e.gzindex=0}e.status=Yi}if(e.status===Yi){if(e.gzhead.name){let s=e.pending,r;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s)),G(i),e.pending!==0)return e.last_flush=-1,Z;s=0}e.gzindex<e.gzhead.name.length?r=e.gzhead.name.charCodeAt(e.gzindex++)&255:r=0,R(e,r)}while(r!==0);e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s)),e.gzindex=0}e.status=Vi}if(e.status===Vi){if(e.gzhead.comment){let s=e.pending,r;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s)),G(i),e.pending!==0)return e.last_flush=-1,Z;s=0}e.gzindex<e.gzhead.comment.length?r=e.gzhead.comment.charCodeAt(e.gzindex++)&255:r=0,R(e,r)}while(r!==0);e.gzhead.hcrc&&e.pending>s&&(i.adler=N(i.adler,e.pending_buf,e.pending-s,s))}e.status=Gi}if(e.status===Gi){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(G(i),e.pending!==0))return e.last_flush=-1,Z;R(e,i.adler&255),R(e,i.adler>>8&255),i.adler=0}if(e.status=Bt,G(i),e.pending!==0)return e.last_flush=-1,Z}if(i.avail_in!==0||e.lookahead!==0||t!==kt&&e.status!==fe){let s=e.level===0?Zs(e,t):e.strategy===Ue?fa(e,t):e.strategy===Vr?ua(e,t):de[e.level].func(e,t);if((s===Lt||s===re)&&(e.status=fe),s===$||s===Lt)return i.avail_out===0&&(e.last_flush=-1),Z;if(s===se&&(t===$r?Hr(e):t!==xn&&(Wi(e,0,0,!1),t===Wr&&(At(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),G(i),i.avail_out===0))return e.last_flush=-1,Z}return t!==K?Z:e.wrap<=0?gn:(e.wrap===2?(R(e,i.adler&255),R(e,i.adler>>8&255),R(e,i.adler>>16&255),R(e,i.adler>>24&255),R(e,i.total_in&255),R(e,i.total_in>>8&255),R(e,i.total_in>>16&255),R(e,i.total_in>>24&255)):(ae(e,i.adler>>>16),ae(e,i.adler&65535)),G(i),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?Z:gn)},ga=i=>{if(ve(i))return ot;const t=i.state.status;return i.state=null,t===Bt?It(i,qr):Z},ya=(i,t)=>{let e=t.length;if(ve(i))return ot;const n=i.state,s=n.wrap;if(s===2||s===1&&n.status!==ee||n.lookahead)return ot;if(s===1&&(i.adler=we(i.adler,t,e,0)),n.wrap=0,e>=n.w_size){s===0&&(At(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(e-n.w_size,e),0),t=c,e=n.w_size}const r=i.avail_in,o=i.next_in,a=i.input;for(i.avail_in=e,i.next_in=0,i.input=t,ie(n);n.lookahead>=T;){let c=n.strstart,h=n.lookahead-(T-1);do n.ins_h=vt(n,n.ins_h,n.window[c+T-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--h);n.strstart=c,n.lookahead=T-1,ie(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=T-1,n.match_available=0,i.next_in=o,i.input=a,i.avail_in=r,n.wrap=s,Z};var ba=_a,wa=$s,Ma=Hs,Aa=Ps,Sa=ma,za=xa,ka=ga,va=ya,Ea="pako deflate (from Nodeca project)",me={deflateInit:ba,deflateInit2:wa,deflateReset:Ma,deflateResetKeep:Aa,deflateSetHeader:Sa,deflate:za,deflateEnd:ka,deflateSetDictionary:va,deflateInfo:Ea};const Fa=(i,t)=>Object.prototype.hasOwnProperty.call(i,t);var Ta=function(i){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const n in e)Fa(e,n)&&(i[n]=e[n])}}return i},Ca=i=>{let t=0;for(let n=0,s=i.length;n<s;n++)t+=i[n].length;const e=new Uint8Array(t);for(let n=0,s=0,r=i.length;n<r;n++){let o=i[n];e.set(o,s),s+=o.length}return e},li={assign:Ta,flattenChunks:Ca};let Ws=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ws=!1}const Me=new Uint8Array(256);for(let i=0;i<256;i++)Me[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Me[254]=Me[254]=1;var Ra=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,e,n,s,r,o=i.length,a=0;for(s=0;s<o;s++)e=i.charCodeAt(s),(e&64512)===55296&&s+1<o&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),s++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(a),r=0,s=0;r<a;s++)e=i.charCodeAt(s),(e&64512)===55296&&s+1<o&&(n=i.charCodeAt(s+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),s++)),e<128?t[r++]=e:e<2048?(t[r++]=192|e>>>6,t[r++]=128|e&63):e<65536?(t[r++]=224|e>>>12,t[r++]=128|e>>>6&63,t[r++]=128|e&63):(t[r++]=240|e>>>18,t[r++]=128|e>>>12&63,t[r++]=128|e>>>6&63,t[r++]=128|e&63);return t};const Da=(i,t)=>{if(t<65534&&i.subarray&&Ws)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let e="";for(let n=0;n<t;n++)e+=String.fromCharCode(i[n]);return e};var Ba=(i,t)=>{const e=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let n,s;const r=new Array(e*2);for(s=0,n=0;n<e;){let o=i[n++];if(o<128){r[s++]=o;continue}let a=Me[o];if(a>4){r[s++]=65533,n+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&n<e;)o=o<<6|i[n++]&63,a--;if(a>1){r[s++]=65533;continue}o<65536?r[s++]=o:(o-=65536,r[s++]=55296|o>>10&1023,r[s++]=56320|o&1023)}return Da(r,s)},Ia=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let e=t-1;for(;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?t:e+Me[i[e]]>t?e:t},Ae={string2buf:Ra,buf2string:Ba,utf8border:Ia};function Oa(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var qs=Oa;const Xs=Object.prototype.toString,{Z_NO_FLUSH:Ua,Z_SYNC_FLUSH:La,Z_FULL_FLUSH:Na,Z_FINISH:Za,Z_OK:si,Z_STREAM_END:Pa,Z_DEFAULT_COMPRESSION:Ha,Z_DEFAULT_STRATEGY:$a,Z_DEFLATED:Wa}=ke;function on(i){this.options=li.assign({level:Ha,method:Wa,chunkSize:16384,windowBits:15,memLevel:8,strategy:$a},i||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qs,this.strm.avail_out=0;let e=me.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==si)throw new Error(te[e]);if(t.header&&me.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Ae.string2buf(t.dictionary):Xs.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,e=me.deflateSetDictionary(this.strm,n),e!==si)throw new Error(te[e]);this._dict_set=!0}}on.prototype.push=function(i,t){const e=this.strm,n=this.options.chunkSize;let s,r;if(this.ended)return!1;for(t===~~t?r=t:r=t===!0?Za:Ua,typeof i=="string"?e.input=Ae.string2buf(i):Xs.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),(r===La||r===Na)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(s=me.deflate(e,r),s===Pa)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),s=me.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===si;if(e.avail_out===0){this.onData(e.output);continue}if(r>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};on.prototype.onData=function(i){this.chunks.push(i)};on.prototype.onEnd=function(i){i===si&&(this.result=li.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};const Le=16209,qa=16191;var Xa=function(t,e){let n,s,r,o,a,c,h,l,f,d,u,p,m,_,x,S,z,g,M,v,y,F,E,b;const k=t.state;n=t.next_in,E=t.input,s=n+(t.avail_in-5),r=t.next_out,b=t.output,o=r-(e-t.avail_out),a=r+(t.avail_out-257),c=k.dmax,h=k.wsize,l=k.whave,f=k.wnext,d=k.window,u=k.hold,p=k.bits,m=k.lencode,_=k.distcode,x=(1<<k.lenbits)-1,S=(1<<k.distbits)-1;t:do{p<15&&(u+=E[n++]<<p,p+=8,u+=E[n++]<<p,p+=8),z=m[u&x];e:for(;;){if(g=z>>>24,u>>>=g,p-=g,g=z>>>16&255,g===0)b[r++]=z&65535;else if(g&16){M=z&65535,g&=15,g&&(p<g&&(u+=E[n++]<<p,p+=8),M+=u&(1<<g)-1,u>>>=g,p-=g),p<15&&(u+=E[n++]<<p,p+=8,u+=E[n++]<<p,p+=8),z=_[u&S];i:for(;;){if(g=z>>>24,u>>>=g,p-=g,g=z>>>16&255,g&16){if(v=z&65535,g&=15,p<g&&(u+=E[n++]<<p,p+=8,p<g&&(u+=E[n++]<<p,p+=8)),v+=u&(1<<g)-1,v>c){t.msg="invalid distance too far back",k.mode=Le;break t}if(u>>>=g,p-=g,g=r-o,v>g){if(g=v-g,g>l&&k.sane){t.msg="invalid distance too far back",k.mode=Le;break t}if(y=0,F=d,f===0){if(y+=h-g,g<M){M-=g;do b[r++]=d[y++];while(--g);y=r-v,F=b}}else if(f<g){if(y+=h+f-g,g-=f,g<M){M-=g;do b[r++]=d[y++];while(--g);if(y=0,f<M){g=f,M-=g;do b[r++]=d[y++];while(--g);y=r-v,F=b}}}else if(y+=f-g,g<M){M-=g;do b[r++]=d[y++];while(--g);y=r-v,F=b}for(;M>2;)b[r++]=F[y++],b[r++]=F[y++],b[r++]=F[y++],M-=3;M&&(b[r++]=F[y++],M>1&&(b[r++]=F[y++]))}else{y=r-v;do b[r++]=b[y++],b[r++]=b[y++],b[r++]=b[y++],M-=3;while(M>2);M&&(b[r++]=b[y++],M>1&&(b[r++]=b[y++]))}}else if(g&64){t.msg="invalid distance code",k.mode=Le;break t}else{z=_[(z&65535)+(u&(1<<g)-1)];continue i}break}}else if(g&64)if(g&32){k.mode=qa;break t}else{t.msg="invalid literal/length code",k.mode=Le;break t}else{z=m[(z&65535)+(u&(1<<g)-1)];continue e}break}}while(n<s&&r<a);M=p>>3,n-=M,p-=M<<3,u&=(1<<p)-1,t.next_in=n,t.next_out=r,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=r<a?257+(a-r):257-(r-a),k.hold=u,k.bits=p};const Ht=15,bn=852,wn=592,Mn=0,bi=1,An=2,Ya=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Va=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Ga=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ja=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ja=(i,t,e,n,s,r,o,a)=>{const c=a.bits;let h=0,l=0,f=0,d=0,u=0,p=0,m=0,_=0,x=0,S=0,z,g,M,v,y,F=null,E;const b=new Uint16Array(Ht+1),k=new Uint16Array(Ht+1);let D=null,B,C,O;for(h=0;h<=Ht;h++)b[h]=0;for(l=0;l<n;l++)b[t[e+l]]++;for(u=c,d=Ht;d>=1&&b[d]===0;d--);if(u>d&&(u=d),d===0)return s[r++]=1<<24|64<<16|0,s[r++]=1<<24|64<<16|0,a.bits=1,0;for(f=1;f<d&&b[f]===0;f++);for(u<f&&(u=f),_=1,h=1;h<=Ht;h++)if(_<<=1,_-=b[h],_<0)return-1;if(_>0&&(i===Mn||d!==1))return-1;for(k[1]=0,h=1;h<Ht;h++)k[h+1]=k[h]+b[h];for(l=0;l<n;l++)t[e+l]!==0&&(o[k[t[e+l]]++]=l);if(i===Mn?(F=D=o,E=20):i===bi?(F=Ya,D=Va,E=257):(F=Ga,D=Ja,E=0),S=0,l=0,h=f,y=r,p=u,m=0,M=-1,x=1<<u,v=x-1,i===bi&&x>bn||i===An&&x>wn)return 1;for(;;){B=h-m,o[l]+1<E?(C=0,O=o[l]):o[l]>=E?(C=D[o[l]-E],O=F[o[l]-E]):(C=96,O=0),z=1<<h-m,g=1<<p,f=g;do g-=z,s[y+(S>>m)+g]=B<<24|C<<16|O|0;while(g!==0);for(z=1<<h-1;S&z;)z>>=1;if(z!==0?(S&=z-1,S+=z):S=0,l++,--b[h]===0){if(h===d)break;h=t[e+o[l]]}if(h>u&&(S&v)!==M){for(m===0&&(m=u),y+=f,p=h-m,_=1<<p;p+m<d&&(_-=b[p+m],!(_<=0));)p++,_<<=1;if(x+=1<<p,i===bi&&x>bn||i===An&&x>wn)return 1;M=S&v,s[M]=u<<24|p<<16|y-r|0}}return S!==0&&(s[y+S]=h-m<<24|64<<16|0),a.bits=u,0};var _e=ja;const Ka=0,Ys=1,Vs=2,{Z_FINISH:Sn,Z_BLOCK:Qa,Z_TREES:Ne,Z_OK:Nt,Z_STREAM_END:th,Z_NEED_DICT:eh,Z_STREAM_ERROR:Q,Z_DATA_ERROR:Gs,Z_MEM_ERROR:Js,Z_BUF_ERROR:ih,Z_DEFLATED:zn}=ke,ci=16180,kn=16181,vn=16182,En=16183,Fn=16184,Tn=16185,Cn=16186,Rn=16187,Dn=16188,Bn=16189,ri=16190,ft=16191,wi=16192,In=16193,Mi=16194,On=16195,Un=16196,Ln=16197,Nn=16198,Ze=16199,Pe=16200,Zn=16201,Pn=16202,Hn=16203,$n=16204,Wn=16205,Ai=16206,qn=16207,Xn=16208,I=16209,js=16210,Ks=16211,nh=852,sh=592,rh=15,ah=rh,Yn=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function hh(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zt=i=>{if(!i)return 1;const t=i.state;return!t||t.strm!==i||t.mode<ci||t.mode>Ks?1:0},Qs=i=>{if(Zt(i))return Q;const t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=ci,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(nh),t.distcode=t.distdyn=new Int32Array(sh),t.sane=1,t.back=-1,Nt},tr=i=>{if(Zt(i))return Q;const t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,Qs(i)},er=(i,t)=>{let e;if(Zt(i))return Q;const n=i.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Q:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=e,n.wbits=t,tr(i))},ir=(i,t)=>{if(!i)return Q;const e=new hh;i.state=e,e.strm=i,e.window=null,e.mode=ci;const n=er(i,t);return n!==Nt&&(i.state=null),n},oh=i=>ir(i,ah);let Vn=!0,Si,zi;const lh=i=>{if(Vn){Si=new Int32Array(512),zi=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(_e(Ys,i.lens,0,288,Si,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;_e(Vs,i.lens,0,32,zi,0,i.work,{bits:5}),Vn=!1}i.lencode=Si,i.lenbits=9,i.distcode=zi,i.distbits=5},nr=(i,t,e,n)=>{let s;const r=i.state;return r.window===null&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new Uint8Array(r.wsize)),n>=r.wsize?(r.window.set(t.subarray(e-r.wsize,e),0),r.wnext=0,r.whave=r.wsize):(s=r.wsize-r.wnext,s>n&&(s=n),r.window.set(t.subarray(e-n,e-n+s),r.wnext),n-=s,n?(r.window.set(t.subarray(e-n,e),0),r.wnext=n,r.whave=r.wsize):(r.wnext+=s,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=s))),0},ch=(i,t)=>{let e,n,s,r,o,a,c,h,l,f,d,u,p,m,_=0,x,S,z,g,M,v,y,F;const E=new Uint8Array(4);let b,k;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zt(i)||!i.output||!i.input&&i.avail_in!==0)return Q;e=i.state,e.mode===ft&&(e.mode=wi),o=i.next_out,s=i.output,c=i.avail_out,r=i.next_in,n=i.input,a=i.avail_in,h=e.hold,l=e.bits,f=a,d=c,F=Nt;t:for(;;)switch(e.mode){case ci:if(e.wrap===0){e.mode=wi;break}for(;l<16;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(e.wrap&2&&h===35615){e.wbits===0&&(e.wbits=15),e.check=0,E[0]=h&255,E[1]=h>>>8&255,e.check=N(e.check,E,2,0),h=0,l=0,e.mode=kn;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((h&255)<<8)+(h>>8))%31){i.msg="incorrect header check",e.mode=I;break}if((h&15)!==zn){i.msg="unknown compression method",e.mode=I;break}if(h>>>=4,l-=4,y=(h&15)+8,e.wbits===0&&(e.wbits=y),y>15||y>e.wbits){i.msg="invalid window size",e.mode=I;break}e.dmax=1<<e.wbits,e.flags=0,i.adler=e.check=1,e.mode=h&512?Bn:ft,h=0,l=0;break;case kn:for(;l<16;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(e.flags=h,(e.flags&255)!==zn){i.msg="unknown compression method",e.mode=I;break}if(e.flags&57344){i.msg="unknown header flags set",e.mode=I;break}e.head&&(e.head.text=h>>8&1),e.flags&512&&e.wrap&4&&(E[0]=h&255,E[1]=h>>>8&255,e.check=N(e.check,E,2,0)),h=0,l=0,e.mode=vn;case vn:for(;l<32;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.head&&(e.head.time=h),e.flags&512&&e.wrap&4&&(E[0]=h&255,E[1]=h>>>8&255,E[2]=h>>>16&255,E[3]=h>>>24&255,e.check=N(e.check,E,4,0)),h=0,l=0,e.mode=En;case En:for(;l<16;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.head&&(e.head.xflags=h&255,e.head.os=h>>8),e.flags&512&&e.wrap&4&&(E[0]=h&255,E[1]=h>>>8&255,e.check=N(e.check,E,2,0)),h=0,l=0,e.mode=Fn;case Fn:if(e.flags&1024){for(;l<16;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.length=h,e.head&&(e.head.extra_len=h),e.flags&512&&e.wrap&4&&(E[0]=h&255,E[1]=h>>>8&255,e.check=N(e.check,E,2,0)),h=0,l=0}else e.head&&(e.head.extra=null);e.mode=Tn;case Tn:if(e.flags&1024&&(u=e.length,u>a&&(u=a),u&&(e.head&&(y=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(n.subarray(r,r+u),y)),e.flags&512&&e.wrap&4&&(e.check=N(e.check,n,u,r)),a-=u,r+=u,e.length-=u),e.length))break t;e.length=0,e.mode=Cn;case Cn:if(e.flags&2048){if(a===0)break t;u=0;do y=n[r+u++],e.head&&y&&e.length<65536&&(e.head.name+=String.fromCharCode(y));while(y&&u<a);if(e.flags&512&&e.wrap&4&&(e.check=N(e.check,n,u,r)),a-=u,r+=u,y)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=Rn;case Rn:if(e.flags&4096){if(a===0)break t;u=0;do y=n[r+u++],e.head&&y&&e.length<65536&&(e.head.comment+=String.fromCharCode(y));while(y&&u<a);if(e.flags&512&&e.wrap&4&&(e.check=N(e.check,n,u,r)),a-=u,r+=u,y)break t}else e.head&&(e.head.comment=null);e.mode=Dn;case Dn:if(e.flags&512){for(;l<16;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(e.wrap&4&&h!==(e.check&65535)){i.msg="header crc mismatch",e.mode=I;break}h=0,l=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),i.adler=e.check=0,e.mode=ft;break;case Bn:for(;l<32;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}i.adler=e.check=Yn(h),h=0,l=0,e.mode=ri;case ri:if(e.havedict===0)return i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=a,e.hold=h,e.bits=l,eh;i.adler=e.check=1,e.mode=ft;case ft:if(t===Qa||t===Ne)break t;case wi:if(e.last){h>>>=l&7,l-=l&7,e.mode=Ai;break}for(;l<3;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}switch(e.last=h&1,h>>>=1,l-=1,h&3){case 0:e.mode=In;break;case 1:if(lh(e),e.mode=Ze,t===Ne){h>>>=2,l-=2;break t}break;case 2:e.mode=Un;break;case 3:i.msg="invalid block type",e.mode=I}h>>>=2,l-=2;break;case In:for(h>>>=l&7,l-=l&7;l<32;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if((h&65535)!==(h>>>16^65535)){i.msg="invalid stored block lengths",e.mode=I;break}if(e.length=h&65535,h=0,l=0,e.mode=Mi,t===Ne)break t;case Mi:e.mode=On;case On:if(u=e.length,u){if(u>a&&(u=a),u>c&&(u=c),u===0)break t;s.set(n.subarray(r,r+u),o),a-=u,r+=u,c-=u,o+=u,e.length-=u;break}e.mode=ft;break;case Un:for(;l<14;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(e.nlen=(h&31)+257,h>>>=5,l-=5,e.ndist=(h&31)+1,h>>>=5,l-=5,e.ncode=(h&15)+4,h>>>=4,l-=4,e.nlen>286||e.ndist>30){i.msg="too many length or distance symbols",e.mode=I;break}e.have=0,e.mode=Ln;case Ln:for(;e.have<e.ncode;){for(;l<3;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.lens[D[e.have++]]=h&7,h>>>=3,l-=3}for(;e.have<19;)e.lens[D[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,b={bits:e.lenbits},F=_e(Ka,e.lens,0,19,e.lencode,0,e.work,b),e.lenbits=b.bits,F){i.msg="invalid code lengths set",e.mode=I;break}e.have=0,e.mode=Nn;case Nn:for(;e.have<e.nlen+e.ndist;){for(;_=e.lencode[h&(1<<e.lenbits)-1],x=_>>>24,S=_>>>16&255,z=_&65535,!(x<=l);){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(z<16)h>>>=x,l-=x,e.lens[e.have++]=z;else{if(z===16){for(k=x+2;l<k;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(h>>>=x,l-=x,e.have===0){i.msg="invalid bit length repeat",e.mode=I;break}y=e.lens[e.have-1],u=3+(h&3),h>>>=2,l-=2}else if(z===17){for(k=x+3;l<k;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}h>>>=x,l-=x,y=0,u=3+(h&7),h>>>=3,l-=3}else{for(k=x+7;l<k;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}h>>>=x,l-=x,y=0,u=11+(h&127),h>>>=7,l-=7}if(e.have+u>e.nlen+e.ndist){i.msg="invalid bit length repeat",e.mode=I;break}for(;u--;)e.lens[e.have++]=y}}if(e.mode===I)break;if(e.lens[256]===0){i.msg="invalid code -- missing end-of-block",e.mode=I;break}if(e.lenbits=9,b={bits:e.lenbits},F=_e(Ys,e.lens,0,e.nlen,e.lencode,0,e.work,b),e.lenbits=b.bits,F){i.msg="invalid literal/lengths set",e.mode=I;break}if(e.distbits=6,e.distcode=e.distdyn,b={bits:e.distbits},F=_e(Vs,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,b),e.distbits=b.bits,F){i.msg="invalid distances set",e.mode=I;break}if(e.mode=Ze,t===Ne)break t;case Ze:e.mode=Pe;case Pe:if(a>=6&&c>=258){i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=a,e.hold=h,e.bits=l,Xa(i,d),o=i.next_out,s=i.output,c=i.avail_out,r=i.next_in,n=i.input,a=i.avail_in,h=e.hold,l=e.bits,e.mode===ft&&(e.back=-1);break}for(e.back=0;_=e.lencode[h&(1<<e.lenbits)-1],x=_>>>24,S=_>>>16&255,z=_&65535,!(x<=l);){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(S&&!(S&240)){for(g=x,M=S,v=z;_=e.lencode[v+((h&(1<<g+M)-1)>>g)],x=_>>>24,S=_>>>16&255,z=_&65535,!(g+x<=l);){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}h>>>=g,l-=g,e.back+=g}if(h>>>=x,l-=x,e.back+=x,e.length=z,S===0){e.mode=Wn;break}if(S&32){e.back=-1,e.mode=ft;break}if(S&64){i.msg="invalid literal/length code",e.mode=I;break}e.extra=S&15,e.mode=Zn;case Zn:if(e.extra){for(k=e.extra;l<k;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.length+=h&(1<<e.extra)-1,h>>>=e.extra,l-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Pn;case Pn:for(;_=e.distcode[h&(1<<e.distbits)-1],x=_>>>24,S=_>>>16&255,z=_&65535,!(x<=l);){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(!(S&240)){for(g=x,M=S,v=z;_=e.distcode[v+((h&(1<<g+M)-1)>>g)],x=_>>>24,S=_>>>16&255,z=_&65535,!(g+x<=l);){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}h>>>=g,l-=g,e.back+=g}if(h>>>=x,l-=x,e.back+=x,S&64){i.msg="invalid distance code",e.mode=I;break}e.offset=z,e.extra=S&15,e.mode=Hn;case Hn:if(e.extra){for(k=e.extra;l<k;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}e.offset+=h&(1<<e.extra)-1,h>>>=e.extra,l-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){i.msg="invalid distance too far back",e.mode=I;break}e.mode=$n;case $n:if(c===0)break t;if(u=d-c,e.offset>u){if(u=e.offset-u,u>e.whave&&e.sane){i.msg="invalid distance too far back",e.mode=I;break}u>e.wnext?(u-=e.wnext,p=e.wsize-u):p=e.wnext-u,u>e.length&&(u=e.length),m=e.window}else m=s,p=o-e.offset,u=e.length;u>c&&(u=c),c-=u,e.length-=u;do s[o++]=m[p++];while(--u);e.length===0&&(e.mode=Pe);break;case Wn:if(c===0)break t;s[o++]=e.length,c--,e.mode=Pe;break;case Ai:if(e.wrap){for(;l<32;){if(a===0)break t;a--,h|=n[r++]<<l,l+=8}if(d-=c,i.total_out+=d,e.total+=d,e.wrap&4&&d&&(i.adler=e.check=e.flags?N(e.check,s,d,o-d):we(e.check,s,d,o-d)),d=c,e.wrap&4&&(e.flags?h:Yn(h))!==e.check){i.msg="incorrect data check",e.mode=I;break}h=0,l=0}e.mode=qn;case qn:if(e.wrap&&e.flags){for(;l<32;){if(a===0)break t;a--,h+=n[r++]<<l,l+=8}if(e.wrap&4&&h!==(e.total&4294967295)){i.msg="incorrect length check",e.mode=I;break}h=0,l=0}e.mode=Xn;case Xn:F=th;break t;case I:F=Gs;break t;case js:return Js;case Ks:default:return Q}return i.next_out=o,i.avail_out=c,i.next_in=r,i.avail_in=a,e.hold=h,e.bits=l,(e.wsize||d!==i.avail_out&&e.mode<I&&(e.mode<Ai||t!==Sn))&&nr(i,i.output,i.next_out,d-i.avail_out),f-=i.avail_in,d-=i.avail_out,i.total_in+=f,i.total_out+=d,e.total+=d,e.wrap&4&&d&&(i.adler=e.check=e.flags?N(e.check,s,d,i.next_out-d):we(e.check,s,d,i.next_out-d)),i.data_type=e.bits+(e.last?64:0)+(e.mode===ft?128:0)+(e.mode===Ze||e.mode===Mi?256:0),(f===0&&d===0||t===Sn)&&F===Nt&&(F=ih),F},uh=i=>{if(Zt(i))return Q;let t=i.state;return t.window&&(t.window=null),i.state=null,Nt},fh=(i,t)=>{if(Zt(i))return Q;const e=i.state;return e.wrap&2?(e.head=t,t.done=!1,Nt):Q},dh=(i,t)=>{const e=t.length;let n,s,r;return Zt(i)||(n=i.state,n.wrap!==0&&n.mode!==ri)?Q:n.mode===ri&&(s=1,s=we(s,t,e,0),s!==n.check)?Gs:(r=nr(i,t,e,e),r?(n.mode=js,Js):(n.havedict=1,Nt))};var ph=tr,mh=er,_h=Qs,xh=oh,gh=ir,yh=ch,bh=uh,wh=fh,Mh=dh,Ah="pako inflate (from Nodeca project)",xt={inflateReset:ph,inflateReset2:mh,inflateResetKeep:_h,inflateInit:xh,inflateInit2:gh,inflate:yh,inflateEnd:bh,inflateGetHeader:wh,inflateSetDictionary:Mh,inflateInfo:Ah};function Sh(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var zh=Sh;const sr=Object.prototype.toString,{Z_NO_FLUSH:kh,Z_FINISH:vh,Z_OK:Se,Z_STREAM_END:ki,Z_NEED_DICT:vi,Z_STREAM_ERROR:Eh,Z_DATA_ERROR:Gn,Z_MEM_ERROR:Fh}=ke;function Ee(i){this.options=li.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new qs,this.strm.avail_out=0;let e=xt.inflateInit2(this.strm,t.windowBits);if(e!==Se)throw new Error(te[e]);if(this.header=new zh,xt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Ae.string2buf(t.dictionary):sr.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=xt.inflateSetDictionary(this.strm,t.dictionary),e!==Se)))throw new Error(te[e])}Ee.prototype.push=function(i,t){const e=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let r,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?vh:kh,sr.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),r=xt.inflate(e,o),r===vi&&s&&(r=xt.inflateSetDictionary(e,s),r===Se?r=xt.inflate(e,o):r===Gn&&(r=vi));e.avail_in>0&&r===ki&&e.state.wrap>0&&i[e.next_in]!==0;)xt.inflateReset(e),r=xt.inflate(e,o);switch(r){case Eh:case Gn:case vi:case Fh:return this.onEnd(r),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(e.avail_out===0||r===ki))if(this.options.to==="string"){let c=Ae.utf8border(e.output,e.next_out),h=e.next_out-c,l=Ae.buf2string(e.output,c);e.next_out=h,e.avail_out=n-h,h&&e.output.set(e.output.subarray(c,c+h),0),this.onData(l)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(r===Se&&a===0)){if(r===ki)return r=xt.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};Ee.prototype.onData=function(i){this.chunks.push(i)};Ee.prototype.onEnd=function(i){i===Se&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=li.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function ln(i,t){const e=new Ee(t);if(e.push(i),e.err)throw e.msg||te[e.err];return e.result}function Th(i,t){return t=t||{},t.raw=!0,ln(i,t)}var Ch=Ee,Rh=ln,Dh=Th,Bh=ln,Ih=ke,Oh={Inflate:Ch,inflate:Rh,inflateRaw:Dh,ungzip:Bh,constants:Ih};const{Inflate:qo,inflate:Uh,inflateRaw:Xo,ungzip:Yo}=Oh;var Lh=Uh,Nh={value:()=>{}};function rr(){for(var i=0,t=arguments.length,e={},n;i<t;++i){if(!(n=arguments[i]+"")||n in e||/[\s.]/.test(n))throw new Error("illegal type: "+n);e[n]=[]}return new Qe(e)}function Qe(i){this._=i}function Zh(i,t){return i.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");if(s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}Qe.prototype=rr.prototype={constructor:Qe,on:function(i,t){var e=this._,n=Zh(i+"",e),s,r=-1,o=n.length;if(arguments.length<2){for(;++r<o;)if((s=(i=n[r]).type)&&(s=Ph(e[s],i.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++r<o;)if(s=(i=n[r]).type)e[s]=Jn(e[s],i.name,t);else if(t==null)for(s in e)e[s]=Jn(e[s],i.name,null);return this},copy:function(){var i={},t=this._;for(var e in t)i[e]=t[e].slice();return new Qe(i)},call:function(i,t){if((s=arguments.length-2)>0)for(var e=new Array(s),n=0,s,r;n<s;++n)e[n]=arguments[n+2];if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(r=this._[i],n=0,s=r.length;n<s;++n)r[n].value.apply(t,e)},apply:function(i,t,e){if(!this._.hasOwnProperty(i))throw new Error("unknown type: "+i);for(var n=this._[i],s=0,r=n.length;s<r;++s)n[s].value.apply(t,e)}};function Ph(i,t){for(var e=0,n=i.length,s;e<n;++e)if((s=i[e]).name===t)return s.value}function Jn(i,t,e){for(var n=0,s=i.length;n<s;++n)if(i[n].name===t){i[n]=Nh,i=i.slice(0,n).concat(i.slice(n+1));break}return e!=null&&i.push({name:t,value:e}),i}var Hh=1e-6,tt=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});function $h(){var i=new tt(9);return tt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function Ot(){var i=new tt(16);return tt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}function Wh(i){var t=new tt(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t}function ji(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i}function ai(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Ei(i,t){if(i===t){var e=t[1],n=t[2],s=t[3],r=t[6],o=t[7],a=t[11];i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=e,i[6]=t[9],i[7]=t[13],i[8]=n,i[9]=r,i[11]=t[14],i[12]=s,i[13]=o,i[14]=a}else i[0]=t[0],i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=t[1],i[5]=t[5],i[6]=t[9],i[7]=t[13],i[8]=t[2],i[9]=t[6],i[10]=t[10],i[11]=t[14],i[12]=t[3],i[13]=t[7],i[14]=t[11],i[15]=t[15];return i}function qh(i,t){var e=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],u=t[11],p=t[12],m=t[13],_=t[14],x=t[15],S=e*a-n*o,z=e*c-s*o,g=e*h-r*o,M=n*c-s*a,v=n*h-r*a,y=s*h-r*c,F=l*m-f*p,E=l*_-d*p,b=l*x-u*p,k=f*_-d*m,D=f*x-u*m,B=d*x-u*_,C=S*B-z*D+g*k+M*b-v*E+y*F;return C?(C=1/C,i[0]=(a*B-c*D+h*k)*C,i[1]=(s*D-n*B-r*k)*C,i[2]=(m*y-_*v+x*M)*C,i[3]=(d*v-f*y-u*M)*C,i[4]=(c*b-o*B-h*E)*C,i[5]=(e*B-s*b+r*E)*C,i[6]=(_*g-p*y-x*z)*C,i[7]=(l*y-d*g+u*z)*C,i[8]=(o*D-a*b+h*F)*C,i[9]=(n*b-e*D-r*F)*C,i[10]=(p*v-m*g+x*S)*C,i[11]=(f*g-l*v-u*S)*C,i[12]=(a*E-o*k-c*F)*C,i[13]=(e*k-n*E+s*F)*C,i[14]=(m*z-p*M-_*S)*C,i[15]=(l*M-f*z+d*S)*C,i):null}function Ut(){var i=new tt(3);return tt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function Xh(i){var t=i[0],e=i[1],n=i[2];return Math.hypot(t,e,n)}function jn(i,t,e){var n=new tt(3);return n[0]=i,n[1]=t,n[2]=e,n}function ti(i,t){var e=t[0],n=t[1],s=t[2],r=e*e+n*n+s*s;return r>0&&(r=1/Math.sqrt(r)),i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i}function Yh(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}function Fi(i,t,e){var n=t[0],s=t[1],r=t[2],o=e[0],a=e[1],c=e[2];return i[0]=s*c-r*a,i[1]=r*o-n*c,i[2]=n*a-s*o,i}function Kn(i,t,e,n){var s=t[0],r=t[1],o=t[2];return i[0]=s+n*(e[0]-s),i[1]=r+n*(e[1]-r),i[2]=o+n*(e[2]-o),i}function Vh(i,t,e){var n=t[0],s=t[1],r=t[2],o=e[3]*n+e[7]*s+e[11]*r+e[15];return o=o||1,i[0]=(e[0]*n+e[4]*s+e[8]*r+e[12])/o,i[1]=(e[1]*n+e[5]*s+e[9]*r+e[13])/o,i[2]=(e[2]*n+e[6]*s+e[10]*r+e[14])/o,i}var Gh=Xh;(function(){var i=Ut();return function(t,e,n,s,r,o){var a,c;for(e||(e=3),n||(n=0),s?c=Math.min(s*e+n,t.length):c=t.length,a=n;a<c;a+=e)i[0]=t[a],i[1]=t[a+1],i[2]=t[a+2],r(i,i,o),t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2];return t}})();function ar(){var i=new tt(4);return tt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function Jh(i,t){var e=t[0],n=t[1],s=t[2],r=t[3],o=e*e+n*n+s*s+r*r;return o>0&&(o=1/Math.sqrt(o)),i[0]=e*o,i[1]=n*o,i[2]=s*o,i[3]=r*o,i}function jh(i,t,e){var n=t[0],s=t[1],r=t[2],o=t[3];return i[0]=e[0]*n+e[4]*s+e[8]*r+e[12]*o,i[1]=e[1]*n+e[5]*s+e[9]*r+e[13]*o,i[2]=e[2]*n+e[6]*s+e[10]*r+e[14]*o,i[3]=e[3]*n+e[7]*s+e[11]*r+e[15]*o,i}(function(){var i=ar();return function(t,e,n,s,r,o){var a,c;for(e||(e=4),n||(n=0),s?c=Math.min(s*e+n,t.length):c=t.length,a=n;a<c;a+=e)i[0]=t[a],i[1]=t[a+1],i[2]=t[a+2],i[3]=t[a+3],r(i,i,o),t[a]=i[0],t[a+1]=i[1],t[a+2]=i[2],t[a+3]=i[3];return t}})();function Ki(){var i=new tt(4);return tt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Kh(i,t,e){e=e*.5;var n=Math.sin(e);return i[0]=n*t[0],i[1]=n*t[1],i[2]=n*t[2],i[3]=Math.cos(e),i}function ei(i,t,e,n){var s=t[0],r=t[1],o=t[2],a=t[3],c=e[0],h=e[1],l=e[2],f=e[3],d,u,p,m,_;return u=s*c+r*h+o*l+a*f,u<0&&(u=-u,c=-c,h=-h,l=-l,f=-f),1-u>Hh?(d=Math.acos(u),p=Math.sin(d),m=Math.sin((1-n)*d)/p,_=Math.sin(n*d)/p):(m=1-n,_=n),i[0]=m*s+_*c,i[1]=m*r+_*h,i[2]=m*o+_*l,i[3]=m*a+_*f,i}function Qh(i,t){var e=t[0]+t[4]+t[8],n;if(e>0)n=Math.sqrt(e+1),i[3]=.5*n,n=.5/n,i[0]=(t[5]-t[7])*n,i[1]=(t[6]-t[2])*n,i[2]=(t[1]-t[3])*n;else{var s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);var r=(s+1)%3,o=(s+2)%3;n=Math.sqrt(t[s*3+s]-t[r*3+r]-t[o*3+o]+1),i[s]=.5*n,n=.5/n,i[3]=(t[r*3+o]-t[o*3+r])*n,i[r]=(t[r*3+s]+t[s*3+r])*n,i[o]=(t[o*3+s]+t[s*3+o])*n}return i}var hr=Jh;(function(){var i=Ut(),t=jn(1,0,0),e=jn(0,1,0);return function(n,s,r){var o=Yh(s,r);return o<-.999999?(Fi(i,t,s),Gh(i)<1e-6&&Fi(i,e,s),ti(i,i),Kh(n,i,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Fi(i,s,r),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=1+o,hr(n,n))}})();(function(){var i=Ki(),t=Ki();return function(e,n,s,r,o,a){return ei(i,n,o,a),ei(t,s,r,a),ei(e,i,t,2*a*(1-a)),e}})();(function(){var i=$h();return function(t,e,n,s){return i[0]=n[0],i[3]=n[1],i[6]=n[2],i[1]=s[0],i[4]=s[1],i[7]=s[2],i[2]=-e[0],i[5]=-e[1],i[8]=-e[2],hr(t,Qh(t,i))}})();const hi={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class to{constructor(t,e,n){const s=this;let r=!1,o=0,a=0,c;const h=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(l){a++,r===!1&&s.onStart!==void 0&&s.onStart(l,o,a),r=!0},this.itemEnd=function(l){o++,s.onProgress!==void 0&&s.onProgress(l,o,a),o===a&&(r=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(l){s.onError!==void 0&&s.onError(l)},this.resolveURL=function(l){return c?c(l):l},this.setURLModifier=function(l){return c=l,this},this.addHandler=function(l,f){return h.push(l,f),this},this.removeHandler=function(l){const f=h.indexOf(l);return f!==-1&&h.splice(f,2),this},this.getHandler=function(l){for(let f=0,d=h.length;f<d;f+=2){const u=h[f],p=h[f+1];if(u.global&&(u.lastIndex=0),u.test(l))return p}return null}}}const eo=new to;class ui{constructor(t){this.manager=t!==void 0?t:eo,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(s,r){n.load(t,s,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}ui.DEFAULT_MATERIAL_NAME="__DEFAULT";const dt={};class io extends Error{constructor(t,e){super(t),this.response=e}}class Qn extends ui{constructor(t){super(t)}load(t,e,n,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const r=hi.get(t);if(r!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(dt[t]!==void 0){dt[t].push({onLoad:e,onProgress:n,onError:s});return}dt[t]=[],dt[t].push({onLoad:e,onProgress:n,onError:s});const o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const l=dt[t],f=h.body.getReader(),d=h.headers.get("Content-Length")||h.headers.get("X-File-Size"),u=d?parseInt(d):0,p=u!==0;let m=0;const _=new ReadableStream({start(x){S();function S(){f.read().then(({done:z,value:g})=>{if(z)x.close();else{m+=g.byteLength;const M=new ProgressEvent("progress",{lengthComputable:p,loaded:m,total:u});for(let v=0,y=l.length;v<y;v++){const F=l[v];F.onProgress&&F.onProgress(M)}x.enqueue(g),S()}})}}});return new Response(_)}else throw new io(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(c){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(l=>new DOMParser().parseFromString(l,a));case"json":return h.json();default:if(a===void 0)return h.text();{const f=/charset="?([^;"\s]*)"?/i.exec(a),d=f&&f[1]?f[1].toLowerCase():void 0,u=new TextDecoder(d);return h.arrayBuffer().then(p=>u.decode(p))}}}).then(h=>{hi.add(t,h);const l=dt[t];delete dt[t];for(let f=0,d=l.length;f<d;f++){const u=l[f];u.onLoad&&u.onLoad(h)}}).catch(h=>{const l=dt[t];if(l===void 0)throw this.manager.itemError(t),h;delete dt[t];for(let f=0,d=l.length;f<d;f++){const u=l[f];u.onError&&u.onError(h)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}const P=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function Fe(){const i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(P[i&255]+P[i>>8&255]+P[i>>16&255]+P[i>>24&255]+"-"+P[t&255]+P[t>>8&255]+"-"+P[t>>16&15|64]+P[t>>24&255]+"-"+P[e&63|128]+P[e>>8&255]+"-"+P[e>>16&255]+P[e>>24&255]+P[n&255]+P[n>>8&255]+P[n>>16&255]+P[n>>24&255]).toLowerCase()}function q(i,t,e){return Math.max(t,Math.min(e,i))}function no(i,t){return(i%t+t)%t}function Ti(i,t,e){return(1-e)*i+e*t}function he(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function W(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}class Te{constructor(t=0,e=0,n=0,s=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=s}static slerpFlat(t,e,n,s,r,o,a){let c=n[s+0],h=n[s+1],l=n[s+2],f=n[s+3];const d=r[o+0],u=r[o+1],p=r[o+2],m=r[o+3];if(a===0){t[e+0]=c,t[e+1]=h,t[e+2]=l,t[e+3]=f;return}if(a===1){t[e+0]=d,t[e+1]=u,t[e+2]=p,t[e+3]=m;return}if(f!==m||c!==d||h!==u||l!==p){let _=1-a;const x=c*d+h*u+l*p+f*m,S=x>=0?1:-1,z=1-x*x;if(z>Number.EPSILON){const M=Math.sqrt(z),v=Math.atan2(M,x*S);_=Math.sin(_*v)/M,a=Math.sin(a*v)/M}const g=a*S;if(c=c*_+d*g,h=h*_+u*g,l=l*_+p*g,f=f*_+m*g,_===1-a){const M=1/Math.sqrt(c*c+h*h+l*l+f*f);c*=M,h*=M,l*=M,f*=M}}t[e]=c,t[e+1]=h,t[e+2]=l,t[e+3]=f}static multiplyQuaternionsFlat(t,e,n,s,r,o){const a=n[s],c=n[s+1],h=n[s+2],l=n[s+3],f=r[o],d=r[o+1],u=r[o+2],p=r[o+3];return t[e]=a*p+l*f+c*u-h*d,t[e+1]=c*p+l*d+h*f-a*u,t[e+2]=h*p+l*u+a*d-c*f,t[e+3]=l*p-a*f-c*d-h*u,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,s){return this._x=t,this._y=e,this._z=n,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const n=t._x,s=t._y,r=t._z,o=t._order,a=Math.cos,c=Math.sin,h=a(n/2),l=a(s/2),f=a(r/2),d=c(n/2),u=c(s/2),p=c(r/2);switch(o){case"XYZ":this._x=d*l*f+h*u*p,this._y=h*u*f-d*l*p,this._z=h*l*p+d*u*f,this._w=h*l*f-d*u*p;break;case"YXZ":this._x=d*l*f+h*u*p,this._y=h*u*f-d*l*p,this._z=h*l*p-d*u*f,this._w=h*l*f+d*u*p;break;case"ZXY":this._x=d*l*f-h*u*p,this._y=h*u*f+d*l*p,this._z=h*l*p+d*u*f,this._w=h*l*f-d*u*p;break;case"ZYX":this._x=d*l*f-h*u*p,this._y=h*u*f+d*l*p,this._z=h*l*p-d*u*f,this._w=h*l*f+d*u*p;break;case"YZX":this._x=d*l*f+h*u*p,this._y=h*u*f+d*l*p,this._z=h*l*p-d*u*f,this._w=h*l*f-d*u*p;break;case"XZY":this._x=d*l*f-h*u*p,this._y=h*u*f-d*l*p,this._z=h*l*p+d*u*f,this._w=h*l*f+d*u*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,s=Math.sin(n);return this._x=t.x*s,this._y=t.y*s,this._z=t.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],s=e[4],r=e[8],o=e[1],a=e[5],c=e[9],h=e[2],l=e[6],f=e[10],d=n+a+f;if(d>0){const u=.5/Math.sqrt(d+1);this._w=.25/u,this._x=(l-c)*u,this._y=(r-h)*u,this._z=(o-s)*u}else if(n>a&&n>f){const u=2*Math.sqrt(1+n-a-f);this._w=(l-c)/u,this._x=.25*u,this._y=(s+o)/u,this._z=(r+h)/u}else if(a>f){const u=2*Math.sqrt(1+a-n-f);this._w=(r-h)/u,this._x=(s+o)/u,this._y=.25*u,this._z=(c+l)/u}else{const u=2*Math.sqrt(1+f-n-a);this._w=(o-s)/u,this._x=(r+h)/u,this._y=(c+l)/u,this._z=.25*u}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(q(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(n===0)return this;const s=Math.min(1,e/n);return this.slerp(t,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,s=t._y,r=t._z,o=t._w,a=e._x,c=e._y,h=e._z,l=e._w;return this._x=n*l+o*a+s*h-r*c,this._y=s*l+o*c+r*a-n*h,this._z=r*l+o*h+n*c-s*a,this._w=o*l-n*a-s*c-r*h,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const n=this._x,s=this._y,r=this._z,o=this._w;let a=o*t._w+n*t._x+s*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=s,this._z=r,this;const c=1-a*a;if(c<=Number.EPSILON){const u=1-e;return this._w=u*o+e*this._w,this._x=u*n+e*this._x,this._y=u*s+e*this._y,this._z=u*r+e*this._z,this.normalize(),this}const h=Math.sqrt(c),l=Math.atan2(h,a),f=Math.sin((1-e)*l)/h,d=Math.sin(e*l)/h;return this._w=o*f+this._w*d,this._x=n*f+this._x*d,this._y=s*f+this._y*d,this._z=r*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),s=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(s),n*Math.sin(r),n*Math.cos(r),e*Math.sin(s))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class A{constructor(t=0,e=0,n=0){A.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return n===void 0&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(ts.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(ts.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,s=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*s,this.y=r[1]*e+r[4]*n+r[7]*s,this.z=r[2]*e+r[5]*n+r[8]*s,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,s=this.z,r=t.elements,o=1/(r[3]*e+r[7]*n+r[11]*s+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*s+r[12])*o,this.y=(r[1]*e+r[5]*n+r[9]*s+r[13])*o,this.z=(r[2]*e+r[6]*n+r[10]*s+r[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,s=this.z,r=t.x,o=t.y,a=t.z,c=t.w,h=2*(o*s-a*n),l=2*(a*e-r*s),f=2*(r*n-o*e);return this.x=e+c*h+o*f-a*l,this.y=n+c*l+a*h-r*f,this.z=s+c*f+r*l-o*h,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,s=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*s,this.y=r[1]*e+r[5]*n+r[9]*s,this.z=r[2]*e+r[6]*n+r[10]*s,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,s=t.y,r=t.z,o=e.x,a=e.y,c=e.z;return this.x=s*c-r*a,this.y=r*o-n*c,this.z=n*a-s*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Ci.copy(this).projectOnVector(t),this.sub(Ci)}reflect(t){return this.sub(Ci.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(q(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,s=this.z-t.z;return e*e+n*n+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const s=Math.sin(e)*t;return this.x=s*Math.sin(n),this.y=Math.cos(e)*t,this.z=s*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),s=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=s,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ci=new A,ts=new Te;class ct{constructor(t=0,e=0){ct.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,s=t.elements;return this.x=s[0]*e+s[3]*n+s[6],this.y=s[1]*e+s[4]*n+s[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(q(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),s=Math.sin(e),r=this.x-t.x,o=this.y-t.y;return this.x=r*n-o*s+t.x,this.y=r*s+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ce{constructor(t=new A(1/0,1/0,1/0),e=new A(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(et.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(et.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=et.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(n!==void 0){const r=n.getAttribute("position");if(e===!0&&r!==void 0&&t.isInstancedMesh!==!0)for(let o=0,a=r.count;o<a;o++)t.isMesh===!0?t.getVertexPosition(o,et):et.fromBufferAttribute(r,o),et.applyMatrix4(t.matrixWorld),this.expandByPoint(et);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),He.copy(t.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),He.copy(n.boundingBox)),He.applyMatrix4(t.matrixWorld),this.union(He)}const s=t.children;for(let r=0,o=s.length;r<o;r++)this.expandByObject(s[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,et),et.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(oe),$e.subVectors(this.max,oe),$t.subVectors(t.a,oe),Wt.subVectors(t.b,oe),qt.subVectors(t.c,oe),yt.subVectors(Wt,$t),bt.subVectors(qt,Wt),Ct.subVectors($t,qt);let e=[0,-yt.z,yt.y,0,-bt.z,bt.y,0,-Ct.z,Ct.y,yt.z,0,-yt.x,bt.z,0,-bt.x,Ct.z,0,-Ct.x,-yt.y,yt.x,0,-bt.y,bt.x,0,-Ct.y,Ct.x,0];return!Ri(e,$t,Wt,qt,$e)||(e=[1,0,0,0,1,0,0,0,1],!Ri(e,$t,Wt,qt,$e))?!1:(We.crossVectors(yt,bt),e=[We.x,We.y,We.z],Ri(e,$t,Wt,qt,$e))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,et).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(et).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(pt[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),pt[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),pt[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),pt[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),pt[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),pt[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),pt[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),pt[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(pt),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const pt=[new A,new A,new A,new A,new A,new A,new A,new A],et=new A,He=new Ce,$t=new A,Wt=new A,qt=new A,yt=new A,bt=new A,Ct=new A,oe=new A,$e=new A,We=new A,Rt=new A;function Ri(i,t,e,n,s){for(let r=0,o=i.length-3;r<=o;r+=3){Rt.fromArray(i,r);const a=s.x*Math.abs(Rt.x)+s.y*Math.abs(Rt.y)+s.z*Math.abs(Rt.z),c=t.dot(Rt),h=e.dot(Rt),l=n.dot(Rt);if(Math.max(-Math.max(c,h,l),Math.min(c,h,l))>a)return!1}return!0}class fi{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const s=this._listeners[t];if(s!==void 0){const r=s.indexOf(e);r!==-1&&s.splice(r,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const s=n.slice(0);for(let r=0,o=s.length;r<o;r++)s[r].call(this,t);t.target=null}}}const es=0,is=1,ns=100,ss=204,rs=205,as=3,so=0,or=300,hs=1e3,qe=1001,os=1002,ro=1006,ao=1008,ho=1009,oo=1015,lo=1023,co=3e3,Di=3001,uo=0,ii="",st="srgb",cn="srgb-linear",fo="display-p3",lr="display-p3-linear",Qi="linear",ls="srgb",cs="rec709",us="p3",Xt=7680,fs=519,ds=35044,Xe=2e3,ps=2001,U=new A,Ye=new ct;class ht{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=n,this.usage=ds,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=oo,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let s=0,r=this.itemSize;s<r;s++)this.array[t+s]=e.array[n+s];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,n=this.count;e<n;e++)Ye.fromBufferAttribute(this,e),Ye.applyMatrix3(t),this.setXY(e,Ye.x,Ye.y);else if(this.itemSize===3)for(let e=0,n=this.count;e<n;e++)U.fromBufferAttribute(this,e),U.applyMatrix3(t),this.setXYZ(e,U.x,U.y,U.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)U.fromBufferAttribute(this,e),U.applyMatrix4(t),this.setXYZ(e,U.x,U.y,U.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)U.fromBufferAttribute(this,e),U.applyNormalMatrix(t),this.setXYZ(e,U.x,U.y,U.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)U.fromBufferAttribute(this,e),U.transformDirection(t),this.setXYZ(e,U.x,U.y,U.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=he(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=W(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=he(e,this.array)),e}setX(t,e){return this.normalized&&(e=W(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=he(e,this.array)),e}setY(t,e){return this.normalized&&(e=W(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=he(e,this.array)),e}setZ(t,e){return this.normalized&&(e=W(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=he(e,this.array)),e}setW(t,e){return this.normalized&&(e=W(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=W(e,this.array),n=W(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,s){return t*=this.itemSize,this.normalized&&(e=W(e,this.array),n=W(n,this.array),s=W(s,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=s,this}setXYZW(t,e,n,s,r){return t*=this.itemSize,this.normalized&&(e=W(e,this.array),n=W(n,this.array),s=W(s,this.array),r=W(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=s,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==ds&&(t.usage=this.usage),t}}class po extends ht{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class mo extends ht{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class _o extends ht{constructor(t,e,n){super(new Float32Array(t),e,n)}}const xo=new Ce,le=new A,Bi=new A;class go{constructor(t=new A,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;e!==void 0?n.copy(e):xo.setFromPoints(t).getCenter(n);let s=0;for(let r=0,o=t.length;r<o;r++)s=Math.max(s,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(s),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;le.subVectors(t,this.center);const e=le.lengthSq();if(e>this.radius*this.radius){const n=Math.sqrt(e),s=(n-this.radius)*.5;this.center.addScaledVector(le,s/n),this.radius+=s}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Bi.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(le.copy(t.center).add(Bi)),this.expandByPoint(le.copy(t.center).sub(Bi))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}class ut{constructor(t,e,n,s,r,o,a,c,h,l,f,d,u,p,m,_){ut.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,n,s,r,o,a,c,h,l,f,d,u,p,m,_)}set(t,e,n,s,r,o,a,c,h,l,f,d,u,p,m,_){const x=this.elements;return x[0]=t,x[4]=e,x[8]=n,x[12]=s,x[1]=r,x[5]=o,x[9]=a,x[13]=c,x[2]=h,x[6]=l,x[10]=f,x[14]=d,x[3]=u,x[7]=p,x[11]=m,x[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ut().fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,s=1/Yt.setFromMatrixColumn(t,0).length(),r=1/Yt.setFromMatrixColumn(t,1).length(),o=1/Yt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*s,e[1]=n[1]*s,e[2]=n[2]*s,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*o,e[9]=n[9]*o,e[10]=n[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,s=t.y,r=t.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(s),h=Math.sin(s),l=Math.cos(r),f=Math.sin(r);if(t.order==="XYZ"){const d=o*l,u=o*f,p=a*l,m=a*f;e[0]=c*l,e[4]=-c*f,e[8]=h,e[1]=u+p*h,e[5]=d-m*h,e[9]=-a*c,e[2]=m-d*h,e[6]=p+u*h,e[10]=o*c}else if(t.order==="YXZ"){const d=c*l,u=c*f,p=h*l,m=h*f;e[0]=d+m*a,e[4]=p*a-u,e[8]=o*h,e[1]=o*f,e[5]=o*l,e[9]=-a,e[2]=u*a-p,e[6]=m+d*a,e[10]=o*c}else if(t.order==="ZXY"){const d=c*l,u=c*f,p=h*l,m=h*f;e[0]=d-m*a,e[4]=-o*f,e[8]=p+u*a,e[1]=u+p*a,e[5]=o*l,e[9]=m-d*a,e[2]=-o*h,e[6]=a,e[10]=o*c}else if(t.order==="ZYX"){const d=o*l,u=o*f,p=a*l,m=a*f;e[0]=c*l,e[4]=p*h-u,e[8]=d*h+m,e[1]=c*f,e[5]=m*h+d,e[9]=u*h-p,e[2]=-h,e[6]=a*c,e[10]=o*c}else if(t.order==="YZX"){const d=o*c,u=o*h,p=a*c,m=a*h;e[0]=c*l,e[4]=m-d*f,e[8]=p*f+u,e[1]=f,e[5]=o*l,e[9]=-a*l,e[2]=-h*l,e[6]=u*f+p,e[10]=d-m*f}else if(t.order==="XZY"){const d=o*c,u=o*h,p=a*c,m=a*h;e[0]=c*l,e[4]=-f,e[8]=h*l,e[1]=d*f+m,e[5]=o*l,e[9]=u*f-p,e[2]=p*f-u,e[6]=a*l,e[10]=m*f+d}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(yo,t,bo)}lookAt(t,e,n){const s=this.elements;return Y.subVectors(t,e),Y.lengthSq()===0&&(Y.z=1),Y.normalize(),wt.crossVectors(n,Y),wt.lengthSq()===0&&(Math.abs(n.z)===1?Y.x+=1e-4:Y.z+=1e-4,Y.normalize(),wt.crossVectors(n,Y)),wt.normalize(),Ve.crossVectors(Y,wt),s[0]=wt.x,s[4]=Ve.x,s[8]=Y.x,s[1]=wt.y,s[5]=Ve.y,s[9]=Y.y,s[2]=wt.z,s[6]=Ve.z,s[10]=Y.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,s=e.elements,r=this.elements,o=n[0],a=n[4],c=n[8],h=n[12],l=n[1],f=n[5],d=n[9],u=n[13],p=n[2],m=n[6],_=n[10],x=n[14],S=n[3],z=n[7],g=n[11],M=n[15],v=s[0],y=s[4],F=s[8],E=s[12],b=s[1],k=s[5],D=s[9],B=s[13],C=s[2],O=s[6],gt=s[10],Re=s[14],De=s[3],Be=s[7],Ie=s[11],Oe=s[15];return r[0]=o*v+a*b+c*C+h*De,r[4]=o*y+a*k+c*O+h*Be,r[8]=o*F+a*D+c*gt+h*Ie,r[12]=o*E+a*B+c*Re+h*Oe,r[1]=l*v+f*b+d*C+u*De,r[5]=l*y+f*k+d*O+u*Be,r[9]=l*F+f*D+d*gt+u*Ie,r[13]=l*E+f*B+d*Re+u*Oe,r[2]=p*v+m*b+_*C+x*De,r[6]=p*y+m*k+_*O+x*Be,r[10]=p*F+m*D+_*gt+x*Ie,r[14]=p*E+m*B+_*Re+x*Oe,r[3]=S*v+z*b+g*C+M*De,r[7]=S*y+z*k+g*O+M*Be,r[11]=S*F+z*D+g*gt+M*Ie,r[15]=S*E+z*B+g*Re+M*Oe,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],s=t[8],r=t[12],o=t[1],a=t[5],c=t[9],h=t[13],l=t[2],f=t[6],d=t[10],u=t[14],p=t[3],m=t[7],_=t[11],x=t[15];return p*(+r*c*f-s*h*f-r*a*d+n*h*d+s*a*u-n*c*u)+m*(+e*c*u-e*h*d+r*o*d-s*o*u+s*h*l-r*c*l)+_*(+e*h*f-e*a*u-r*o*f+n*o*u+r*a*l-n*h*l)+x*(-s*a*l-e*c*f+e*a*d+s*o*f-n*o*d+n*c*l)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=e,s[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],c=t[6],h=t[7],l=t[8],f=t[9],d=t[10],u=t[11],p=t[12],m=t[13],_=t[14],x=t[15],S=f*_*h-m*d*h+m*c*u-a*_*u-f*c*x+a*d*x,z=p*d*h-l*_*h-p*c*u+o*_*u+l*c*x-o*d*x,g=l*m*h-p*f*h+p*a*u-o*m*u-l*a*x+o*f*x,M=p*f*c-l*m*c-p*a*d+o*m*d+l*a*_-o*f*_,v=e*S+n*z+s*g+r*M;if(v===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const y=1/v;return t[0]=S*y,t[1]=(m*d*r-f*_*r-m*s*u+n*_*u+f*s*x-n*d*x)*y,t[2]=(a*_*r-m*c*r+m*s*h-n*_*h-a*s*x+n*c*x)*y,t[3]=(f*c*r-a*d*r-f*s*h+n*d*h+a*s*u-n*c*u)*y,t[4]=z*y,t[5]=(l*_*r-p*d*r+p*s*u-e*_*u-l*s*x+e*d*x)*y,t[6]=(p*c*r-o*_*r-p*s*h+e*_*h+o*s*x-e*c*x)*y,t[7]=(o*d*r-l*c*r+l*s*h-e*d*h-o*s*u+e*c*u)*y,t[8]=g*y,t[9]=(p*f*r-l*m*r-p*n*u+e*m*u+l*n*x-e*f*x)*y,t[10]=(o*m*r-p*a*r+p*n*h-e*m*h-o*n*x+e*a*x)*y,t[11]=(l*a*r-o*f*r-l*n*h+e*f*h+o*n*u-e*a*u)*y,t[12]=M*y,t[13]=(l*m*s-p*f*s+p*n*d-e*m*d-l*n*_+e*f*_)*y,t[14]=(p*a*s-o*m*s-p*n*c+e*m*c+o*n*_-e*a*_)*y,t[15]=(o*f*s-l*a*s+l*n*c-e*f*c-o*n*d+e*a*d)*y,this}scale(t){const e=this.elements,n=t.x,s=t.y,r=t.z;return e[0]*=n,e[4]*=s,e[8]*=r,e[1]*=n,e[5]*=s,e[9]*=r,e[2]*=n,e[6]*=s,e[10]*=r,e[3]*=n,e[7]*=s,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,s))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),s=Math.sin(e),r=1-n,o=t.x,a=t.y,c=t.z,h=r*o,l=r*a;return this.set(h*o+n,h*a-s*c,h*c+s*a,0,h*a+s*c,l*a+n,l*c-s*o,0,h*c-s*a,l*c+s*o,r*c*c+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,s,r,o){return this.set(1,n,r,0,t,1,o,0,e,s,1,0,0,0,0,1),this}compose(t,e,n){const s=this.elements,r=e._x,o=e._y,a=e._z,c=e._w,h=r+r,l=o+o,f=a+a,d=r*h,u=r*l,p=r*f,m=o*l,_=o*f,x=a*f,S=c*h,z=c*l,g=c*f,M=n.x,v=n.y,y=n.z;return s[0]=(1-(m+x))*M,s[1]=(u+g)*M,s[2]=(p-z)*M,s[3]=0,s[4]=(u-g)*v,s[5]=(1-(d+x))*v,s[6]=(_+S)*v,s[7]=0,s[8]=(p+z)*y,s[9]=(_-S)*y,s[10]=(1-(d+m))*y,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this}decompose(t,e,n){const s=this.elements;let r=Yt.set(s[0],s[1],s[2]).length();const o=Yt.set(s[4],s[5],s[6]).length(),a=Yt.set(s[8],s[9],s[10]).length();this.determinant()<0&&(r=-r),t.x=s[12],t.y=s[13],t.z=s[14],it.copy(this);const h=1/r,l=1/o,f=1/a;return it.elements[0]*=h,it.elements[1]*=h,it.elements[2]*=h,it.elements[4]*=l,it.elements[5]*=l,it.elements[6]*=l,it.elements[8]*=f,it.elements[9]*=f,it.elements[10]*=f,e.setFromRotationMatrix(it),n.x=r,n.y=o,n.z=a,this}makePerspective(t,e,n,s,r,o,a=Xe){const c=this.elements,h=2*r/(e-t),l=2*r/(n-s),f=(e+t)/(e-t),d=(n+s)/(n-s);let u,p;if(a===Xe)u=-(o+r)/(o-r),p=-2*o*r/(o-r);else if(a===ps)u=-o/(o-r),p=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=h,c[4]=0,c[8]=f,c[12]=0,c[1]=0,c[5]=l,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=u,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(t,e,n,s,r,o,a=Xe){const c=this.elements,h=1/(e-t),l=1/(n-s),f=1/(o-r),d=(e+t)*h,u=(n+s)*l;let p,m;if(a===Xe)p=(o+r)*f,m=-2*f;else if(a===ps)p=r*f,m=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*l,c[9]=0,c[13]=-u,c[2]=0,c[6]=0,c[10]=m,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let s=0;s<16;s++)if(e[s]!==n[s])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Yt=new A,it=new ut,yo=new A(0,0,0),bo=new A(1,1,1),wt=new A,Ve=new A,Y=new A,ms=new ut,_s=new Te;class di{constructor(t=0,e=0,n=0,s=di.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,s=this._order){return this._x=t,this._y=e,this._z=n,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const s=t.elements,r=s[0],o=s[4],a=s[8],c=s[1],h=s[5],l=s[9],f=s[2],d=s[6],u=s[10];switch(e){case"XYZ":this._y=Math.asin(q(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-l,u),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(d,h),this._z=0);break;case"YXZ":this._x=Math.asin(-q(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(a,u),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-f,r),this._z=0);break;case"ZXY":this._x=Math.asin(q(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,u),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,r));break;case"ZYX":this._y=Math.asin(-q(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,u),this._z=Math.atan2(c,r)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(q(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-f,r)):(this._x=0,this._y=Math.atan2(a,u));break;case"XZY":this._z=Math.asin(-q(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,h),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-l,u),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return ms.makeRotationFromQuaternion(t),this.setFromRotationMatrix(ms,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return _s.setFromEuler(this),this.setFromQuaternion(_s,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}di.DEFAULT_ORDER="XYZ";class wo{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}class Tt{constructor(t,e,n,s,r,o,a,c,h){Tt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,n,s,r,o,a,c,h)}set(t,e,n,s,r,o,a,c,h){const l=this.elements;return l[0]=t,l[1]=s,l[2]=a,l[3]=e,l[4]=r,l[5]=c,l[6]=n,l[7]=o,l[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,s=e.elements,r=this.elements,o=n[0],a=n[3],c=n[6],h=n[1],l=n[4],f=n[7],d=n[2],u=n[5],p=n[8],m=s[0],_=s[3],x=s[6],S=s[1],z=s[4],g=s[7],M=s[2],v=s[5],y=s[8];return r[0]=o*m+a*S+c*M,r[3]=o*_+a*z+c*v,r[6]=o*x+a*g+c*y,r[1]=h*m+l*S+f*M,r[4]=h*_+l*z+f*v,r[7]=h*x+l*g+f*y,r[2]=d*m+u*S+p*M,r[5]=d*_+u*z+p*v,r[8]=d*x+u*g+p*y,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],c=t[6],h=t[7],l=t[8];return e*o*l-e*a*h-n*r*l+n*a*c+s*r*h-s*o*c}invert(){const t=this.elements,e=t[0],n=t[1],s=t[2],r=t[3],o=t[4],a=t[5],c=t[6],h=t[7],l=t[8],f=l*o-a*h,d=a*c-l*r,u=h*r-o*c,p=e*f+n*d+s*u;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return t[0]=f*m,t[1]=(s*h-l*n)*m,t[2]=(a*n-s*o)*m,t[3]=d*m,t[4]=(l*e-s*c)*m,t[5]=(s*r-a*e)*m,t[6]=u*m,t[7]=(n*c-h*e)*m,t[8]=(o*e-n*r)*m,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,s,r,o,a){const c=Math.cos(r),h=Math.sin(r);return this.set(n*c,n*h,-n*(c*o+h*a)+o+t,-s*h,s*c,-s*(-h*o+c*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(Ii.makeScale(t,e)),this}rotate(t){return this.premultiply(Ii.makeRotation(-t)),this}translate(t,e){return this.premultiply(Ii.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let s=0;s<9;s++)if(e[s]!==n[s])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Ii=new Tt;let Mo=0;const xs=new A,Vt=new Te,mt=new ut,Ge=new A,ce=new A,Ao=new A,So=new Te,gs=new A(1,0,0),ys=new A(0,1,0),bs=new A(0,0,1),zo={type:"added"},ko={type:"removed"};class Et extends fi{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Mo++}),this.uuid=Fe(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Et.DEFAULT_UP.clone();const t=new A,e=new di,n=new Te,s=new A(1,1,1);function r(){n.setFromEuler(e,!1)}function o(){e.setFromQuaternion(n,void 0,!1)}e._onChange(r),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new ut},normalMatrix:{value:new Tt}}),this.matrix=new ut,this.matrixWorld=new ut,this.matrixAutoUpdate=Et.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Et.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new wo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Vt.setFromAxisAngle(t,e),this.quaternion.multiply(Vt),this}rotateOnWorldAxis(t,e){return Vt.setFromAxisAngle(t,e),this.quaternion.premultiply(Vt),this}rotateX(t){return this.rotateOnAxis(gs,t)}rotateY(t){return this.rotateOnAxis(ys,t)}rotateZ(t){return this.rotateOnAxis(bs,t)}translateOnAxis(t,e){return xs.copy(t).applyQuaternion(this.quaternion),this.position.add(xs.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(gs,t)}translateY(t){return this.translateOnAxis(ys,t)}translateZ(t){return this.translateOnAxis(bs,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(mt.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Ge.copy(t):Ge.set(t,e,n);const s=this.parent;this.updateWorldMatrix(!0,!1),ce.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mt.lookAt(ce,Ge,this.up):mt.lookAt(Ge,ce,this.up),this.quaternion.setFromRotationMatrix(mt),s&&(mt.extractRotation(s.matrixWorld),Vt.setFromRotationMatrix(mt),this.quaternion.premultiply(Vt.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(zo)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(ko)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),mt.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),mt.multiply(t.parent.matrixWorld)),t.applyMatrix4(mt),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,s=this.children.length;n<s;n++){const o=this.children[n].getObjectByProperty(t,e);if(o!==void 0)return o}}getObjectsByProperty(t,e,n=[]){this[t]===e&&n.push(this);const s=this.children;for(let r=0,o=s.length;r<o;r++)s[r].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ce,t,Ao),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ce,So,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,s=e.length;n<s;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let n=0,s=e.length;n<s;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,s=e.length;n<s;n++){const r=e[n];(r.matrixWorldAutoUpdate===!0||t===!0)&&r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const s=this.children;for(let r=0,o=s.length;r<o;r++){const a=s[r];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function r(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(t)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=r(t.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let h=0,l=c.length;h<l;h++){const f=c[h];r(t.shapes,f)}else r(t.shapes,c)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,h=this.material.length;c<h;c++)a.push(r(t.materials,this.material[c]));s.material=a}else s.material=r(t.materials,this.material);if(this.children.length>0){s.children=[];for(let a=0;a<this.children.length;a++)s.children.push(this.children[a].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];s.animations.push(r(t.animations,c))}}if(e){const a=o(t.geometries),c=o(t.materials),h=o(t.textures),l=o(t.images),f=o(t.shapes),d=o(t.skeletons),u=o(t.animations),p=o(t.nodes);a.length>0&&(n.geometries=a),c.length>0&&(n.materials=c),h.length>0&&(n.textures=h),l.length>0&&(n.images=l),f.length>0&&(n.shapes=f),d.length>0&&(n.skeletons=d),u.length>0&&(n.animations=u),p.length>0&&(n.nodes=p)}return n.object=s,n;function o(a){const c=[];for(const h in a){const l=a[h];delete l.metadata,c.push(l)}return c}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){const s=t.children[n];this.add(s.clone())}return this}}Et.DEFAULT_UP=new A(0,1,0);Et.DEFAULT_MATRIX_AUTO_UPDATE=!0;Et.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;function vo(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}function tn(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const ws={};function Oi(i){i in ws||(ws[i]=!0,console.warn(i))}let Eo=0;const j=new ut,Ui=new Et,Gt=new A,V=new Ce,ue=new Ce,L=new A;class un extends fi{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Eo++}),this.uuid=Fe(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(vo(t)?mo:po)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const r=new Tt().getNormalMatrix(t);n.applyNormalMatrix(r),n.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(t),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return j.makeRotationFromQuaternion(t),this.applyMatrix4(j),this}rotateX(t){return j.makeRotationX(t),this.applyMatrix4(j),this}rotateY(t){return j.makeRotationY(t),this.applyMatrix4(j),this}rotateZ(t){return j.makeRotationZ(t),this.applyMatrix4(j),this}translate(t,e,n){return j.makeTranslation(t,e,n),this.applyMatrix4(j),this}scale(t,e,n){return j.makeScale(t,e,n),this.applyMatrix4(j),this}lookAt(t){return Ui.lookAt(t),Ui.updateMatrix(),this.applyMatrix4(Ui.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gt).negate(),this.translate(Gt.x,Gt.y,Gt.z),this}setFromPoints(t){const e=[];for(let n=0,s=t.length;n<s;n++){const r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new _o(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ce);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,s=e.length;n<s;n++){const r=e[n];V.setFromBufferAttribute(r),this.morphTargetsRelative?(L.addVectors(this.boundingBox.min,V.min),this.boundingBox.expandByPoint(L),L.addVectors(this.boundingBox.max,V.max),this.boundingBox.expandByPoint(L)):(this.boundingBox.expandByPoint(V.min),this.boundingBox.expandByPoint(V.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new go);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new A,1/0);return}if(t){const n=this.boundingSphere.center;if(V.setFromBufferAttribute(t),e)for(let r=0,o=e.length;r<o;r++){const a=e[r];ue.setFromBufferAttribute(a),this.morphTargetsRelative?(L.addVectors(V.min,ue.min),V.expandByPoint(L),L.addVectors(V.max,ue.max),V.expandByPoint(L)):(V.expandByPoint(ue.min),V.expandByPoint(ue.max))}V.getCenter(n);let s=0;for(let r=0,o=t.count;r<o;r++)L.fromBufferAttribute(t,r),s=Math.max(s,n.distanceToSquared(L));if(e)for(let r=0,o=e.length;r<o;r++){const a=e[r],c=this.morphTargetsRelative;for(let h=0,l=a.count;h<l;h++)L.fromBufferAttribute(a,h),c&&(Gt.fromBufferAttribute(t,h),L.add(Gt)),s=Math.max(s,n.distanceToSquared(L))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,s=e.position.array,r=e.normal.array,o=e.uv.array,a=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ht(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,h=[],l=[];for(let b=0;b<a;b++)h[b]=new A,l[b]=new A;const f=new A,d=new A,u=new A,p=new ct,m=new ct,_=new ct,x=new A,S=new A;function z(b,k,D){f.fromArray(s,b*3),d.fromArray(s,k*3),u.fromArray(s,D*3),p.fromArray(o,b*2),m.fromArray(o,k*2),_.fromArray(o,D*2),d.sub(f),u.sub(f),m.sub(p),_.sub(p);const B=1/(m.x*_.y-_.x*m.y);isFinite(B)&&(x.copy(d).multiplyScalar(_.y).addScaledVector(u,-m.y).multiplyScalar(B),S.copy(u).multiplyScalar(m.x).addScaledVector(d,-_.x).multiplyScalar(B),h[b].add(x),h[k].add(x),h[D].add(x),l[b].add(S),l[k].add(S),l[D].add(S))}let g=this.groups;g.length===0&&(g=[{start:0,count:n.length}]);for(let b=0,k=g.length;b<k;++b){const D=g[b],B=D.start,C=D.count;for(let O=B,gt=B+C;O<gt;O+=3)z(n[O+0],n[O+1],n[O+2])}const M=new A,v=new A,y=new A,F=new A;function E(b){y.fromArray(r,b*3),F.copy(y);const k=h[b];M.copy(k),M.sub(y.multiplyScalar(y.dot(k))).normalize(),v.crossVectors(F,k);const B=v.dot(l[b])<0?-1:1;c[b*4]=M.x,c[b*4+1]=M.y,c[b*4+2]=M.z,c[b*4+3]=B}for(let b=0,k=g.length;b<k;++b){const D=g[b],B=D.start,C=D.count;for(let O=B,gt=B+C;O<gt;O+=3)E(n[O+0]),E(n[O+1]),E(n[O+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new ht(new Float32Array(e.count*3),3),this.setAttribute("normal",n);else for(let d=0,u=n.count;d<u;d++)n.setXYZ(d,0,0,0);const s=new A,r=new A,o=new A,a=new A,c=new A,h=new A,l=new A,f=new A;if(t)for(let d=0,u=t.count;d<u;d+=3){const p=t.getX(d+0),m=t.getX(d+1),_=t.getX(d+2);s.fromBufferAttribute(e,p),r.fromBufferAttribute(e,m),o.fromBufferAttribute(e,_),l.subVectors(o,r),f.subVectors(s,r),l.cross(f),a.fromBufferAttribute(n,p),c.fromBufferAttribute(n,m),h.fromBufferAttribute(n,_),a.add(l),c.add(l),h.add(l),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,c.x,c.y,c.z),n.setXYZ(_,h.x,h.y,h.z)}else for(let d=0,u=e.count;d<u;d+=3)s.fromBufferAttribute(e,d+0),r.fromBufferAttribute(e,d+1),o.fromBufferAttribute(e,d+2),l.subVectors(o,r),f.subVectors(s,r),l.cross(f),n.setXYZ(d+0,l.x,l.y,l.z),n.setXYZ(d+1,l.x,l.y,l.z),n.setXYZ(d+2,l.x,l.y,l.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)L.fromBufferAttribute(t,e),L.normalize(),t.setXYZ(e,L.x,L.y,L.z)}toNonIndexed(){function t(a,c){const h=a.array,l=a.itemSize,f=a.normalized,d=new h.constructor(c.length*l);let u=0,p=0;for(let m=0,_=c.length;m<_;m++){a.isInterleavedBufferAttribute?u=c[m]*a.data.stride+a.offset:u=c[m]*l;for(let x=0;x<l;x++)d[p++]=h[u++]}return new ht(d,l,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new un,n=this.index.array,s=this.attributes;for(const a in s){const c=s[a],h=t(c,n);e.setAttribute(a,h)}const r=this.morphAttributes;for(const a in r){const c=[],h=r[a];for(let l=0,f=h.length;l<f;l++){const d=h[l],u=t(d,n);c.push(u)}e.morphAttributes[a]=c}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const h=o[a];e.addGroup(h.start,h.count,h.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(t[h]=c[h]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const c in n){const h=n[c];t.data.attributes[c]=h.toJSON(t.data)}const s={};let r=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],l=[];for(let f=0,d=h.length;f<d;f++){const u=h[f];l.push(u.toJSON(t.data))}l.length>0&&(s[c]=l,r=!0)}r&&(t.data.morphAttributes=s,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(e));const s=t.attributes;for(const h in s){const l=s[h];this.setAttribute(h,l.clone(e))}const r=t.morphAttributes;for(const h in r){const l=[],f=r[h];for(let d=0,u=f.length;d<u;d++)l.push(f[d].clone(e));this.morphAttributes[h]=l}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let h=0,l=o.length;h<l;h++){const f=o[h];this.addGroup(f.start,f.count,f.materialIndex)}const a=t.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=t.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ms=new Tt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),As=new Tt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Je={[cn]:{transfer:Qi,primaries:cs,toReference:i=>i,fromReference:i=>i},[st]:{transfer:ls,primaries:cs,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[lr]:{transfer:Qi,primaries:us,toReference:i=>i.applyMatrix3(As),fromReference:i=>i.applyMatrix3(Ms)},[fo]:{transfer:ls,primaries:us,toReference:i=>i.convertSRGBToLinear().applyMatrix3(As),fromReference:i=>i.applyMatrix3(Ms).convertLinearToSRGB()}},Fo=new Set([cn,lr]),nt={enabled:!0,_workingColorSpace:cn,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!Fo.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,t,e){if(this.enabled===!1||t===e||!t||!e)return i;const n=Je[t].toReference,s=Je[e].fromReference;return s(n(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this._workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this._workingColorSpace)},getPrimaries:function(i){return Je[i].primaries},getTransfer:function(i){return i===ii?Qi:Je[i].transfer}};function Kt(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Li(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const cr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Mt={h:0,s:0,l:0},je={h:0,s:0,l:0};function Ni(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}class Qt{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(e===void 0&&n===void 0){const s=t;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=st){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,nt.toWorkingColorSpace(this,e),this}setRGB(t,e,n,s=nt.workingColorSpace){return this.r=t,this.g=e,this.b=n,nt.toWorkingColorSpace(this,s),this}setHSL(t,e,n,s=nt.workingColorSpace){if(t=no(t,1),e=q(e,0,1),n=q(n,0,1),e===0)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+e):n+e-n*e,o=2*n-r;this.r=Ni(o,r,t+1/3),this.g=Ni(o,r,t),this.b=Ni(o,r,t-1/3)}return nt.toWorkingColorSpace(this,s),this}setStyle(t,e=st){function n(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(t)){let r;const o=s[1],a=s[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,e);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,e);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const r=s[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(r,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=st){const n=cr[t.toLowerCase()];return n!==void 0?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Kt(t.r),this.g=Kt(t.g),this.b=Kt(t.b),this}copyLinearToSRGB(t){return this.r=Li(t.r),this.g=Li(t.g),this.b=Li(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=st){return nt.fromWorkingColorSpace(H.copy(this),t),Math.round(q(H.r*255,0,255))*65536+Math.round(q(H.g*255,0,255))*256+Math.round(q(H.b*255,0,255))}getHexString(t=st){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=nt.workingColorSpace){nt.fromWorkingColorSpace(H.copy(this),e);const n=H.r,s=H.g,r=H.b,o=Math.max(n,s,r),a=Math.min(n,s,r);let c,h;const l=(a+o)/2;if(a===o)c=0,h=0;else{const f=o-a;switch(h=l<=.5?f/(o+a):f/(2-o-a),o){case n:c=(s-r)/f+(s<r?6:0);break;case s:c=(r-n)/f+2;break;case r:c=(n-s)/f+4;break}c/=6}return t.h=c,t.s=h,t.l=l,t}getRGB(t,e=nt.workingColorSpace){return nt.fromWorkingColorSpace(H.copy(this),e),t.r=H.r,t.g=H.g,t.b=H.b,t}getStyle(t=st){nt.fromWorkingColorSpace(H.copy(this),t);const e=H.r,n=H.g,s=H.b;return t!==st?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(n*255)},${Math.round(s*255)})`}offsetHSL(t,e,n){return this.getHSL(Mt),this.setHSL(Mt.h+t,Mt.s+e,Mt.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Mt),t.getHSL(je);const n=Ti(Mt.h,je.h,e),s=Ti(Mt.s,je.s,e),r=Ti(Mt.l,je.l,e);return this.setHSL(n,s,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,s=this.b,r=t.elements;return this.r=r[0]*e+r[3]*n+r[6]*s,this.g=r[1]*e+r[4]*n+r[7]*s,this.b=r[2]*e+r[5]*n+r[8]*s,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const H=new Qt;Qt.NAMES=cr;let To=0;class Co extends fi{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:To++}),this.uuid=Fe(),this.name="",this.type="Material",this.blending=is,this.side=es,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=ss,this.blendDst=rs,this.blendEquation=ns,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Qt(0,0,0),this.blendAlpha=0,this.depthFunc=as,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=fs,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xt,this.stencilZFail=Xt,this.stencilZPass=Xt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const n=t[e];if(n===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const s=this[e];if(s===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(n):s&&s.isVector3&&n&&n.isVector3?s.copy(n):this[e]=n}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==is&&(n.blending=this.blending),this.side!==es&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==ss&&(n.blendSrc=this.blendSrc),this.blendDst!==rs&&(n.blendDst=this.blendDst),this.blendEquation!==ns&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==as&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==fs&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Xt&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Xt&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Xt&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function s(r){const o=[];for(const a in r){const c=r[a];delete c.metadata,o.push(c)}return o}if(e){const r=s(t.textures),o=s(t.images);r.length>0&&(n.textures=r),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(e!==null){const s=e.length;n=new Array(s);for(let r=0;r!==s;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}class Ro extends Co{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Qt(16777215),this.specular=new Qt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=uo,this.normalScale=new ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=so,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class en{constructor(t,e,n,s){w(this,"model");w(this,"anim");w(this,"bone");w(this,"flags");w(this,"frames");w(this,"matrix");w(this,"tmpMat");w(this,"tmpMat2");w(this,"tmpPos");w(this,"tmpRot");w(this,"tmpScale");w(this,"index");this.model=t,this.anim=e;const r=n.getUint32();this.bone=n.getString().toLowerCase(),this.flags=n.getUint32(),this.frames=new Array(r);let o=[1,1,1];for(let a=0;a<r;++a){const c=[n.getFloat(),n.getFloat(),n.getFloat()],h=[n.getFloat(),n.getFloat(),n.getFloat(),n.getFloat()];s>=3&&(o=[n.getFloat(),n.getFloat(),n.getFloat()]),this.frames[a]={pos:c,rot:h,scale:o}}this.matrix=Ot(),this.tmpMat=Ot(),this.tmpMat2=Ot(),this.tmpPos=Ut(),this.tmpRot=Ki(),this.tmpScale=Ut()}update(t,e,n){if(this.model.bones==null||this.model.transforms==null)return;this.index=t;const s=this.model.bones[t].parent,r=e%this.frames.length,o=(e+1)%this.frames.length;Kn(this.tmpPos,this.frames[r].pos,this.frames[o].pos,n),Kn(this.tmpScale,this.frames[r].scale,this.frames[o].scale,n),ei(this.tmpRot,this.frames[r].rot,this.frames[o].rot,n),this.translation(this.tmpMat2,this.tmpPos),this.rotationQuat(this.tmpMat,this.tmpRot),this.mulSlimDX(this.matrix,this.tmpMat,this.tmpMat2),s!=-1&&this.mulSlimDX(this.matrix,this.matrix,this.model.transforms[s]),ji(this.model.transforms[t],this.matrix)}translation(t,e){return ai(t),t[12]=e[0],t[13]=e[1],t[14]=e[2],t}rotationQuat(t,e){ai(t);const n=e[0]*e[0],s=e[1]*e[1],r=e[2]*e[2],o=e[0]*e[1],a=e[2]*e[3],c=e[2]*e[0],h=e[1]*e[3],l=e[1]*e[2],f=e[0]*e[3];return t[0]=1-2*(s+r),t[1]=2*(o+a),t[2]=2*(c-h),t[4]=2*(o-a),t[5]=1-2*(r+n),t[6]=2*(l+f),t[8]=2*(c+h),t[9]=2*(l-f),t[10]=1-2*(s+n),t}mulSlimDX(t,e,n){const s={M11:e[0],M12:e[1],M13:e[2],M14:e[3],M21:e[4],M22:e[5],M23:e[6],M24:e[7],M31:e[8],M32:e[9],M33:e[10],M34:e[11],M41:e[12],M42:e[13],M43:e[14],M44:e[15]},r={M11:n[0],M12:n[1],M13:n[2],M14:n[3],M21:n[4],M22:n[5],M23:n[6],M24:n[7],M31:n[8],M32:n[9],M33:n[10],M34:n[11],M41:n[12],M42:n[13],M43:n[14],M44:n[15]};return t[0]=s.M11*r.M11+s.M12*r.M21+s.M13*r.M31+s.M14*r.M41,t[1]=s.M11*r.M12+s.M12*r.M22+s.M13*r.M32+s.M14*r.M42,t[2]=s.M11*r.M13+s.M12*r.M23+s.M13*r.M33+s.M14*r.M43,t[3]=s.M11*r.M14+s.M12*r.M24+s.M13*r.M34+s.M14*r.M44,t[4]=s.M21*r.M11+s.M22*r.M21+s.M23*r.M31+s.M24*r.M41,t[5]=s.M21*r.M12+s.M22*r.M22+s.M23*r.M32+s.M24*r.M42,t[6]=s.M21*r.M13+s.M22*r.M23+s.M23*r.M33+s.M24*r.M43,t[7]=s.M21*r.M14+s.M22*r.M24+s.M23*r.M34+s.M24*r.M44,t[8]=s.M31*r.M11+s.M32*r.M21+s.M33*r.M31+s.M34*r.M41,t[9]=s.M31*r.M12+s.M32*r.M22+s.M33*r.M32+s.M34*r.M42,t[10]=s.M31*r.M13+s.M32*r.M23+s.M33*r.M33+s.M34*r.M43,t[11]=s.M31*r.M14+s.M32*r.M24+s.M33*r.M34+s.M34*r.M44,t[12]=s.M41*r.M11+s.M42*r.M21+s.M43*r.M31+s.M44*r.M41,t[13]=s.M41*r.M12+s.M42*r.M22+s.M43*r.M32+s.M44*r.M42,t[14]=s.M41*r.M13+s.M42*r.M23+s.M43*r.M33+s.M44*r.M43,t[15]=s.M41*r.M14+s.M42*r.M24+s.M43*r.M34+s.M44*r.M44,t}}class Do{constructor(t,e,n){w(this,"model");w(this,"name");w(this,"fps");w(this,"bones");w(this,"lookup");w(this,"duration");this.model=t,this.name=e.getString().toLowerCase(),this.fps=e.getInt32();const s=e.getUint32();this.bones=new Array(s),this.lookup={};for(let r=0;r<s;++r)this.bones[r]=new en(t,this,e,n),this.lookup[this.bones[r].bone]=r;s==0||this.fps<=1?this.duration=1e3:this.duration=Math.floor(1e3*(this.bones[0].frames.length/this.fps))}}class Zi{constructor(t){w(this,"buffer");w(this,"position");this.buffer=new DataView(t),this.position=0}getBool(){const t=this.buffer.getUint8(this.position)!=0;return this.position+=1,t}getUint8(){const t=this.buffer.getUint8(this.position);return this.position+=1,t}getInt8(){const t=this.buffer.getInt8(this.position);return this.position+=1,t}getUint16(){const t=this.buffer.getUint16(this.position,!0);return this.position+=2,t}getInt16(){const t=this.buffer.getInt16(this.position,!0);return this.position+=2,t}getUint32(){const t=this.buffer.getUint32(this.position,!0);return this.position+=4,t}getInt32(){const t=this.buffer.getInt32(this.position,!0);return this.position+=4,t}getFloat(){const t=this.buffer.getFloat32(this.position,!0);return this.position+=4,t}getString(t){t===void 0&&(t=this.getUint16());let e="";for(let n=0;n<t;++n)e+=String.fromCharCode(this.getUint8());return e}setBool(t){this.buffer.setUint8(this.position,t?1:0),this.position+=1}setUint8(t){this.buffer.setUint8(this.position,t),this.position+=1}setInt8(t){this.buffer.setInt8(this.position,t),this.position+=1}setUint16(t){this.buffer.setUint16(this.position,t,!0),this.position+=2}setInt16(t){this.buffer.setInt16(this.position,t,!0),this.position+=2}setUint32(t){this.buffer.setUint32(this.position,t,!0),this.position+=4}setInt32(t){this.buffer.setInt32(this.position,t,!0),this.position+=4}setFloat(t){this.buffer.setFloat32(this.position,t,!0),this.position+=4}}class Bo{constructor(t,e,n){w(this,"model");w(this,"index");w(this,"name");w(this,"parent");w(this,"scale");w(this,"origMatrix");w(this,"baseMatrix");w(this,"incrMatrix");this.model=t,this.index=e,this.name=n.getString().toLowerCase(),this.parent=n.getInt32(),this.scale=n.getFloat(),this.origMatrix=Ot();for(let s=0;s<16;++s)this.origMatrix[s]=n.getFloat();if(this.baseMatrix=Wh(this.origMatrix),Ei(this.baseMatrix,this.baseMatrix),qh(this.baseMatrix,this.baseMatrix),Ei(this.origMatrix,this.origMatrix),this.incrMatrix=Ot(),t.version>=2){for(let s=0;s<16;++s)this.incrMatrix[s]=n.getFloat();Ei(this.incrMatrix,this.incrMatrix)}else ai(this.incrMatrix)}}class Io{constructor(t){w(this,"position");w(this,"normal");w(this,"u");w(this,"v");w(this,"bones");w(this,"weights");this.position=[t.getFloat(),t.getFloat(),t.getFloat()],this.normal=[t.getFloat(),t.getFloat(),t.getFloat(),0],this.u=t.getFloat(),this.v=t.getFloat(),this.bones=new Array(4);for(let e=0;e<4;++e)this.bones[e]=t.getUint8();this.weights=new Array(4);for(let e=0;e<4;++e)this.weights[e]=t.getFloat()}}class Oo extends ui{constructor(t){super(t)}load(t,e,n,s){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,o=hi.get(t);if(o!==void 0)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;const a=tn("img");function c(){l(),hi.add(t,this),e&&e(this),r.manager.itemEnd(t)}function h(f){l(),s&&s(f),r.manager.itemError(t),r.manager.itemEnd(t)}function l(){a.removeEventListener("load",c,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",h,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}let Jt;class Uo{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Jt===void 0&&(Jt=tn("canvas")),Jt.width=t.width,Jt.height=t.height;const n=Jt.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Jt}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=tn("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const s=n.getImageData(0,0,t.width,t.height),r=s.data;for(let o=0;o<r.length;o++)r[o]=Kt(r[o]/255)*255;return n.putImageData(s,0,0),e}else if(t.data){const e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(Kt(e[n]/255)*255):e[n]=Kt(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Lo=0;class No{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Lo++}),this.uuid=Fe(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},s=this.data;if(s!==null){let r;if(Array.isArray(s)){r=[];for(let o=0,a=s.length;o<a;o++)s[o].isDataTexture?r.push(Pi(s[o].image)):r.push(Pi(s[o]))}else r=Pi(s);n.url=r}return e||(t.images[this.uuid]=n),n}}function Pi(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?Uo.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Zo=0;class Ft extends fi{constructor(t=Ft.DEFAULT_IMAGE,e=Ft.DEFAULT_MAPPING,n=qe,s=qe,r=ro,o=ao,a=lo,c=ho,h=Ft.DEFAULT_ANISOTROPY,l=ii){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Zo++}),this.uuid=Fe(),this.name="",this.source=new No(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=r,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=c,this.offset=new ct(0,0),this.repeat=new ct(1,1),this.center=new ct(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Tt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof l=="string"?this.colorSpace=l:(Oi("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=l===Di?st:ii),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==or)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case hs:t.x=t.x-Math.floor(t.x);break;case qe:t.x=t.x<0?0:1;break;case os:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case hs:t.y=t.y-Math.floor(t.y);break;case qe:t.y=t.y<0?0:1;break;case os:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Oi("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===st?Di:co}set encoding(t){Oi("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Di?st:ii}}Ft.DEFAULT_IMAGE=null;Ft.DEFAULT_MAPPING=or;Ft.DEFAULT_ANISOTROPY=1;class Po extends ui{constructor(t){super(t)}load(t,e,n,s){const r=new Ft,o=new Oo(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(a){r.image=a,r.needsUpdate=!0,e!==void 0&&e(r)},n,s),r}}class Ho{constructor(t,e){w(this,"model");w(this,"url");w(this,"texture");this.model=t,this.url=e,this.texture=null,this.load()}load(){this.texture=new Po().load(this.url,t=>{this.onLoad.call(this,t)})}onLoad(t){t.flipY=!1,this.model.material.map=t,this.model.material.needsUpdate=!0,this.model.dispatch.call("loadTexture")}}class $o{constructor(t){w(this,"champion");w(this,"skin");w(this,"baseUrl");w(this,"meshUrl");w(this,"setFrame");w(this,"loaded");w(this,"animsLoaded");w(this,"meshes",null);w(this,"vertices",null);w(this,"indices",null);w(this,"transforms",null);w(this,"bones",null);w(this,"boneLookup");w(this,"enableTexture");w(this,"animIndex");w(this,"animName");w(this,"newAnimation");w(this,"animCycle");w(this,"animTime");w(this,"deltaTime");w(this,"tmpMat");w(this,"tmpVec");w(this,"animStatus");w(this,"dispatch");w(this,"ambientColor");w(this,"primaryColor");w(this,"secondaryColor");w(this,"lightDir1");w(this,"lightDir2");w(this,"lightDir3");w(this,"texture");w(this,"geometry");w(this,"material");w(this,"animations",null);w(this,"version",null);w(this,"vbData",null);this.champion=t.champion||"1",this.skin=t.skin||0,this.baseUrl="https://lolking-models.justabayet.com/",this.meshUrl=this.baseUrl+`models/${this.champion}_${this.skin}.lmesh`,this.setFrame=t.setFrame,this.loaded=!1,this.animsLoaded=!1,this.meshes=null,this.vertices=null,this.indices=null,this.transforms=null,this.bones=null,this.boneLookup={},this.enableTexture=t.enableTexture!=null?t.enableTexture:!0,this.animIndex=-1,this.animName=null,this.newAnimation=!1,this.animCycle=!0,this.animTime=0,this.deltaTime=0,this.tmpMat=Ot(),this.tmpVec=ar(),this.animStatus=!0,this.dispatch=rr("load","loadMesh","loadTexture","loadAnim"),this.ambientColor=[.35,.35,.35,1],this.primaryColor=[1,1,1,1],this.secondaryColor=[.35,.35,.35,1],this.lightDir1=Ut(),this.lightDir2=Ut(),this.lightDir3=Ut(),ti(this.lightDir1,[5,5,-5]),ti(this.lightDir2,[5,5,5]),ti(this.lightDir3,[-5,-5,-5]),this.texture=null,this.geometry=new un,this.material=new Ro;const e=new Promise(s=>{this.dispatch.on("loadMesh.Model",()=>{s()})}),n=new Promise(s=>{this.dispatch.on("loadAnim.Model",()=>{s()})});Promise.all([e,n]).then(()=>{this.dispatch.call("load")})}getAnimations(){if(!this.animations)return null;const t=[];return this.animations.forEach(function(e){t.push(e.name)}),t}getAnimation(t){let e=-1;if(!this.animations)return e;if(t=t.toLowerCase(),t=="idle"||t=="attack"){const n=[],s=new RegExp(t+"[0-9]*");for(let r=0;r<this.animations.length;++r)this.animations[r].name.search(s)==0&&n.push(r);n.length>0&&(e=n[0])}else for(let n=0;n<this.animations.length;++n)if(this.animations[n].name==t){e=n;break}return e}setAnimation(t){t=="default"?this.setDefaultAnimation():(this.animName=t,this.animTime=0,this.deltaTime=0,this.newAnimation=!0)}setAnimationOnce(t){t=="default"?this.setDefaultAnimation():this.getAnimation(t)!==-1&&(this.animName=t,this.animCycle=!1,this.animTime=0,this.deltaTime=0,this.newAnimation=!0)}setDefaultAnimation(){const t=this.getAnimations();let e=!1;for(const n in t)if(n=="idle"||n=="idle1"||n=="idle01"||n=="idle02"){this.setAnimation(n),e=!0;break}if(!e){for(const n in t)if(n=="attack"||n=="attack1"||n=="attack01"||n=="attack02"){this.setAnimation(n),e=!0;break}}}toggleAnimation(){this.animStatus=!this.animStatus}update(t){if(this.animTime==0&&(this.animTime=t),!this.animName||!this.loaded||!this.vertices||!this.animations||!this.bones||!this.transforms||this.animations.length==0)return;this.animIndex=this.getAnimation(this.animName),this.animIndex==-1;let e=this.animations[this.animIndex];if(this.animStatus?this.deltaTime=t-this.animTime:this.animTime=t-this.deltaTime,this.deltaTime>=e.duration&&(this.animTime=t,this.deltaTime=0,!this.animCycle&&!this.newAnimation&&(this.setDefaultAnimation(),this.animCycle=!0,this.animTime=t,this.animIndex=this.getAnimation(this.animName),this.deltaTime=t-this.animTime,e=this.animations[this.animIndex])),this.animStatus){const n=1e3/e.fps;let s,r;if(this.setFrame==null?(r=Math.floor(this.deltaTime/n),s=this.deltaTime%n/n):(r=Math.floor(this.setFrame),s=this.setFrame-r),this.version&&this.version>=1)for(let m=0;m<this.bones.length;++m){const _=this.bones[m];e.lookup[_.name]!==void 0?e.bones[e.lookup[_.name]].update(m,r,s):_.parent!=-1?en.prototype.mulSlimDX(this.transforms[m],_.incrMatrix,this.transforms[_.parent]):ji(this.transforms[m],_.incrMatrix)}else for(let m=0;m<e.bones.length;++m){const _=e.bones[m];if(this.boneLookup[_.bone]!==void 0)_.update(this.boneLookup[_.bone],r,s);else{const x=e.bones[m-1];if(!x)continue;const S=x.index;S+1<this.transforms.length&&ji(this.transforms[S+1],this.transforms[S]),_.index=S+1}}const o=Math.min(this.transforms.length,this.bones.length);for(let m=0;m<o;++m)en.prototype.mulSlimDX(this.transforms[m],this.bones[m].baseMatrix,this.transforms[m]);ai(this.tmpMat);const a=this.tmpVec,c=this.vertices.length,h=this.geometry.attributes.position.array,l=this.geometry.attributes.normal.array;let f,d,u,p;for(let m=0;m<c;++m){f=this.vertices[m],p=m*3,h[p]=h[p+1]=h[p+2]=0,l[p]=l[p+1]=l[p+2]=0;for(let _=0;_<4;++_)f.weights[_]>0&&(d=f.weights[_],u=e.fps==1?this.tmpMat:this.transforms[f.bones[_]],Vh(a,f.position,u),h[p]+=a[0]*d,h[p+1]+=a[1]*d,h[p+2]+=a[2]*d,jh(a,f.normal,u),l[p]+=a[0]*d,l[p+1]+=a[1]*d,l[p+2]+=a[2]*d)}this.geometry.attributes.position.needsUpdate=!0,this.geometry.attributes.normal.needsUpdate=!0}this.newAnimation&&(this.newAnimation=!1)}load(){const t=new Qn;t.setResponseType("arraybuffer"),t.load(this.meshUrl,e=>{this.loadMesh(e)})}loadMesh(t){if(!t){console.error("Bad buffer for DataView");return}const e=new Zi(t);let n,s;try{if(e.getUint32()!=604210091){console.log("Bad magic value");return}}catch(f){alert("Model currently isn't loading! We're sorry and hope to have this fixed soon."),console.log(f);return}this.version=e.getUint32();const r=e.getString(),o=e.getString();if(r&&r.length>0){const f=new Qn;f.setResponseType("arraybuffer");const d=this.baseUrl+`models/${r}.lanim`;f.load(d,u=>{this.loadAnim(u),this.dispatch.call("loadAnim")},void 0,()=>{this.dispatch.call("loadAnim")})}this.enableTexture&&o&&o.length>0&&(this.texture=new Ho(this,this.baseUrl+`textures/${this.champion}/`+o+".png"));const a=e.getUint32();if(a>0){this.meshes=new Array(a);for(let f=0;f<a;++f){const d=e.getString().toLowerCase(),u=e.getUint32(),p=e.getUint32(),m=e.getUint32(),_=e.getUint32();this.meshes[f]={name:d,vStart:u,vCount:p,iStart:m,iCount:_}}}const c=e.getUint32();if(c>0){this.vertices=new Array(c),this.vbData=new Float32Array(c*8);const f=[],d=[],u=[];for(let p=0;p<c;++p)s=p*8,this.vertices[p]=n=new Io(e),this.vbData[s]=n.position[0],this.vbData[s+1]=n.position[1],this.vbData[s+2]=n.position[2],this.vbData[s+3]=n.normal[0],this.vbData[s+4]=n.normal[1],this.vbData[s+5]=n.normal[2],this.vbData[s+6]=n.u,this.vbData[s+7]=n.v,f.push(n.position[0],n.position[1],n.position[2]),d.push(n.normal[0],n.normal[1],n.normal[2]),u.push(n.u,n.v);this.geometry.setAttribute("position",new ht(new Float32Array(f),3)),this.geometry.setAttribute("normal",new ht(new Float32Array(d),3)),this.geometry.setAttribute("uv",new ht(new Float32Array(u),2))}const h=e.getUint32();if(h>0){this.indices=new Array(h);for(let f=0;f<h;++f)this.indices[f]=e.getUint16();this.geometry.setIndex(new ht(new Uint16Array(this.indices),1))}const l=e.getUint32();if(l>0){this.transforms=new Array(l),this.bones=new Array(l);for(let f=0;f<l;++f)this.bones[f]=new Bo(this,f,e),this.boneLookup[this.bones[f].name]!==void 0&&(this.bones[f].name=this.bones[f].name+"2"),this.boneLookup[this.bones[f].name]=f,this.transforms[f]=Ot()}this.loaded=!0,this.dispatch.call("loadMesh")}loadAnim(t){if(!t){console.error("Bad buffer for DataView");return}let e=new Zi(t);if(e.getUint32()!=604210092){console.log("Bad magic value");return}const s=e.getUint32();if(s>=2){const o=new Uint8Array(t,e.position);let a=null;try{a=Lh(o)}catch(c){console.log("Decompression error: "+c);return}e=new Zi(a.buffer)}const r=e.getUint32();if(r>0){this.animations=new Array(r);for(let o=0;o<r;++o)this.animations[o]=new Do(this,e,s)}this.animsLoaded=!0}on(t,e){this.dispatch.on(t,e)}}class Vo{constructor(){}load(t,e,n){return new Promise((s,r)=>{const o=new $o({champion:t,skin:e,...n});o.load(),o.on("load",()=>{o.animsLoaded?s(o):r()})})}}export{Vo as default};
